#################################
### Leviathan & Enclave Events###
### by Maximilian Olbers	  ###
### & Niclas Karlsson		  ###
### & Rufus Tronde			  ###
### & Henrik Thyrwall			  ###
#################################

namespace = leviathans

### Trader Enclave ###

# Traders Main Menu #1 (Initial)
country_event = {
	id = leviathans.100
	title = leviathans.100.name
	desc = leviathans.100a.desc
	desc = leviathans.100b.desc
	desc = leviathans.100c.desc
	desc = leviathans.100d.desc
	desc = leviathans.100e.desc
	desc = leviathans.100f.desc
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}
	
	trigger = {
		from = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country_1
		}
		NOT = { has_country_flag = attacked_xuracorp }
		NOT = { has_country_flag = trader_enclave_diplomacy_engaged }
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
		FROM = { save_event_target_as = traders }
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
	
	option = {
		name = TASTY
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = EXTERMINATE
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
	
	option = { # Manufactured Goods
		name = leviathans.105.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr2
				NOT = { has_country_flag = goods_trade_xuracorp }
			}
			custom_tooltip = {
				fail_text = leviathans.105.c.galactic_market
				has_global_flag = galactic_market_founded
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.1 }
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr2
				has_active_xuracorp_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.131 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}
	
	option = { # XuraGel
		name = leviathans.105.pop.b
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = purchased_xuragel
			}
			OR = {
				is_robot_empire = no
				has_valid_civic = civic_machine_servitor
				has_valid_civic = civic_machine_assimilator
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.b.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 75
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.10 }
		}
	}
	
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = trader_special_deal_timed_flag
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.13 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = trader_special_deal_timed_flag
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.pop.c.response
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			OR = {
				has_active_xuracorp_trade = yes
				has_active_enclave_resource_trade = yes
			}
		}
		custom_tooltip = end_trade_1
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_xuracorp_trades = yes
			remove_enclave_resource_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Traders Main Menu #2 (Initial)
country_event = {
	id = leviathans.103
	title = leviathans.103.name
	desc = leviathans.103a.desc
	desc = leviathans.103b.desc
	desc = leviathans.103c.desc
	desc = leviathans.103d.desc
	desc = leviathans.103e.desc
	desc = leviathans.103f.desc
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}
	
	trigger = {
		from = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country_2
		}
		NOT = { has_country_flag = trader_enclave_diplomacy_engaged }
		NOT = { has_country_flag = attacked_riggans }
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
		FROM = { save_event_target_as = traders }
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
	}
	
	option = {
		name = TASTY
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}

	option = {
		name = EXTERMINATE
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}
	
	option = { # Manufactured Goods
		name = leviathans.105.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr1
				NOT = { has_country_flag = goods_trade_riggan }
			}
			custom_tooltip = {
				fail_text = leviathans.105.c.galactic_market
				has_global_flag = galactic_market_founded
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.4 }
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr1
				has_active_riggan_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.130 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}
	
	option = { # Riggan Spice
		name = leviathans.103.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = purchased_riggan_spice
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.b.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 75
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.11 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = trader_special_deal_timed_flag
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.14 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = trader_special_deal_timed_flag
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.pop.c.response
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			OR = {
				has_active_riggan_trade = yes
				has_active_enclave_resource_trade = yes
			}
		}
		custom_tooltip = end_trade_2
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_riggan_trades = yes
			remove_enclave_resource_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		default_hide_option = yes
	}
}

# Traders Main Menu #3 (Initial)
country_event = {
	id = leviathans.104
	title = leviathans.104.name
	desc = leviathans.104a.desc
	desc = leviathans.104b.desc
	desc = leviathans.104c.desc
	desc = leviathans.104d.desc
	desc = leviathans.104e.desc
	desc = leviathans.104f.desc
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}
	
	trigger = {
		from = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country_3
		}
		NOT = { has_country_flag = trader_enclave_diplomacy_engaged }
		NOT = { has_country_flag = attacked_muutagans }
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
		FROM = { save_event_target_as = traders }
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
	}
	
	option = {
		name = TASTY
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}

	option = {
		name = EXTERMINATE
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}
	
	option = { # Manufactured Goods
		name = leviathans.105.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr3
				NOT = { has_country_flag = goods_trade_muutagan }
			}
			custom_tooltip = {
				fail_text = leviathans.105.c.galactic_market
				has_global_flag = galactic_market_founded
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.7 }
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr3
				has_active_muutagan_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.132 }
		}
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			OR = {
				has_active_muutagan_trade = yes
				has_active_enclave_resource_trade = yes
			}
		}
		custom_tooltip = end_trade_3
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_muutagan_trades = yes
			remove_enclave_resource_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}
	
	option = { # Muutagan Crystals
		name = leviathans.104.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = purchased_muutagans_crystals
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.b.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 75
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.12 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = trader_special_deal_timed_flag
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.15 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = trader_special_deal_timed_flag
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.pop.c.response
	}

	option = {
		name = leviathans.105.d
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		default_hide_option = yes
	}
}

# Traders Main Menu #1
country_event = {
	id = leviathans.105
	title = leviathans.100.name
	desc = leviathans.100a.desc
	desc = leviathans.100b.desc
	desc = leviathans.100c.desc
	desc = leviathans.100d.desc
	desc = leviathans.100e.desc
	desc = leviathans.100f.desc
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
	
	option = { # Manufactured Goods
		name = leviathans.105.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr2
				NOT = { has_country_flag = goods_trade_xuracorp }
			}
			custom_tooltip = {
				fail_text = leviathans.105.c.galactic_market
				has_global_flag = galactic_market_founded
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.1 }
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr2
				has_active_xuracorp_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.131 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}
	
	option = { # XuraGel
		name = leviathans.105.pop.b
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = purchased_xuragel
			}
			OR = {
				is_robot_empire = no
				has_valid_civic = civic_machine_servitor
				has_valid_civic = civic_machine_assimilator
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.b.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 75
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.10 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = trader_special_deal_timed_flag
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.13 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = trader_special_deal_timed_flag
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.pop.c.response
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			OR = {
				has_active_xuracorp_trade = yes
				has_active_enclave_resource_trade = yes
			}
		}
		custom_tooltip = end_trade_1
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_xuracorp_trades = yes
			remove_enclave_resource_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		default_hide_option = yes
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Traders Main Menu #2
country_event = {
	id = leviathans.106
	title = leviathans.103.name
	desc = leviathans.103a.desc
	desc = leviathans.103b.desc
	desc = leviathans.103c.desc
	desc = leviathans.103d.desc
	desc = leviathans.103e.desc
	desc = leviathans.103f.desc
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
	
	option = { # Manufactured Goods
		name = leviathans.105.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr1
				NOT = { has_country_flag = goods_trade_riggan }
			}
			custom_tooltip = {
				fail_text = leviathans.105.c.galactic_market
				has_global_flag = galactic_market_founded
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.4 }
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr1
				has_active_riggan_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.130 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}
	
	option = { # Riggan Spice
		name = leviathans.103.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = purchased_riggan_spice
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.b.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 75
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.11 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = trader_special_deal_timed_flag
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.14 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = trader_special_deal_timed_flag
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.pop.c.response
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			OR = {
				has_active_riggan_trade = yes
				has_active_enclave_resource_trade = yes
			}
		}
		custom_tooltip = end_trade_2
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_riggan_trades = yes
			remove_enclave_resource_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		default_hide_option = yes
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Traders Main Menu #3
country_event = {
	id = leviathans.107
	title = leviathans.104.name
	desc = leviathans.104a.desc
	desc = leviathans.104b.desc
	desc = leviathans.104c.desc
	desc = leviathans.104d.desc
	desc = leviathans.104e.desc
	desc = leviathans.104f.desc
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
	
	option = { # Manufactured Goods
		name = leviathans.105.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr3
				NOT = { has_country_flag = goods_trade_muutagan }
			}
			custom_tooltip = {
				fail_text = leviathans.105.c.galactic_market
				has_global_flag = galactic_market_founded
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.7 }
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr3
				has_active_muutagan_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.132 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}
	
	option = { # Muutagan Crystals
		name = leviathans.104.pop.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = purchased_muutagans_crystals
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.b.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 75
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.12 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = trader_special_deal_timed_flag
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = spaceleviathans.15 }
		}
	}
	option = { # Special Deal
		name = leviathans.105.pop.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = trader_special_deal_timed_flag
		}
		allow = {
			custom_tooltip = {
				text = leviathans.105.pop.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 100
					}
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.pop.c.response
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			OR = {
				has_active_muutagan_trade = yes
				has_active_enclave_resource_trade = yes
			}
		}
		custom_tooltip = end_trade_3
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_muutagan_trades = yes
			remove_enclave_resource_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		default_hide_option = yes
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Trader Opinion from Resource Deals
country_event = {
	id = leviathans.122
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = event_target:traders
		OR = {
			AND = {
				event_target:traders = { has_country_flag = trader_enclave_country_1 }
				has_active_xuracorp_trade = yes
			}
			AND = {
				event_target:traders = { has_country_flag = trader_enclave_country_2 }
				has_active_riggan_trade = yes
			}
			AND = {
				event_target:traders = { has_country_flag = trader_enclave_country_3 }
				has_active_muutagan_trade = yes
			}
			AND = {
				event_target:traders = {
					OR = {
						has_country_flag = trader_enclave_country_1
						has_country_flag = trader_enclave_country_2
						has_country_flag = trader_enclave_country_3
					}
				}
				has_active_enclave_resource_trade = yes
			}
		}
	}

	immediate = {
		if = {
			limit = {
				OR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						OR = {
							has_modifier = enclave_trade_1_xur
							has_modifier = enclave_trade_2_xur
							has_modifier = enclave_trade_1_eng_all
							has_modifier = enclave_trade_1_eng_con
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						OR = {
							has_modifier = enclave_trade_1_rig
							has_modifier = enclave_trade_2_rig
							has_modifier = enclave_trade_1_eng_all
							has_modifier = enclave_trade_1_eng_con
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						OR = {
							has_modifier = enclave_trade_1_mut
							has_modifier = enclave_trade_2_mut
							has_modifier = enclave_trade_1_eng_all
							has_modifier = enclave_trade_1_eng_con
						}
					}
				}
			}
			event_target:traders = {
				add_trust = {
					who = root
					amount = 1
				}
			}
			country_event = { id = leviathans.122 days = 30 }
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						OR = {
							has_modifier = enclave_trade_3_xur
							has_modifier = enclave_trade_4_xur
							has_modifier = enclave_trade_2_eng_all
							has_modifier = enclave_trade_2_eng_con
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						OR = {
							has_modifier = enclave_trade_3_rig
							has_modifier = enclave_trade_4_rig
							has_modifier = enclave_trade_2_eng_all
							has_modifier = enclave_trade_2_eng_con
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						OR = {
							has_modifier = enclave_trade_3_mut
							has_modifier = enclave_trade_4_mut
							has_modifier = enclave_trade_2_eng_all
							has_modifier = enclave_trade_2_eng_con
						}
					}
				}
			}
			event_target:traders = {
				add_trust = {
					who = root
					amount = 2
				}
			}
			country_event = { id = leviathans.122 days = 30 }
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						OR = {
							has_modifier = enclave_trade_5_xur
							has_modifier = enclave_trade_3_eng_all
							has_modifier = enclave_trade_3_eng_con
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						OR = {
							has_modifier = enclave_trade_5_rig
							has_modifier = enclave_trade_3_eng_all
							has_modifier = enclave_trade_3_eng_con
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						OR = {
							has_modifier = enclave_trade_5_mut
							has_modifier = enclave_trade_3_eng_all
							has_modifier = enclave_trade_3_eng_con
						}
					}
				}
			}
			event_target:traders = {
				add_trust = {
					who = root
					amount = 3
				}
			}
			country_event = { id = leviathans.122 days = 30 }
		}
	}
}

# Any Trader Destroyed (Destroyer)
country_event = {
	id = leviathans.141
	title = "leviathans.141"
	desc = "leviathans.141.desc"
	picture = GFX_evt_space_debris
	location = event_target:trader_system
	show_sound = event_ship_bridge
	
	is_triggered_only = yes
	
	immediate = {
		set_country_flag = destroyed_trader
		every_country = {
			limit = {
				OR = { is_country_type = default is_country_type = ascended_empire is_country_type = lost_empire }
				NOR = {
					is_same_value = root
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_hive_devouring_swarm
					has_valid_civic = civic_machine_terminator
				}
			}
			add_opinion_modifier = {
				who = root
				modifier = opinion_destroyed_trader
			}
		}
		remove_enclave_resource_trades = yes
		remove_relation_flag = {
			who = FROM
			flag = enclave_resource_trade 
		}
		if = {
			limit = { FROM = { has_country_flag = trader_enclave_country_1 } }
			remove_xuracorp_trades = yes
			remove_relation_flag = {
				who = FROM
				flag = xuracorp_trade 
			}
		}
		else_if = {
			limit = { FROM = { has_country_flag = trader_enclave_country_2 } }
			remove_riggan_trades = yes
			remove_relation_flag = {
				who = FROM
				flag = riggan_trade 
			}
		}
		else_if = {
			limit = { FROM = { has_country_flag = trader_enclave_country_3 } }
			remove_muutagan_trades = yes
			remove_relation_flag = {
				who = FROM
				flag = muutagan_trade 
			}
		}
	}
	
	option = {
		name = EXCELLENT
		add_resource = {
			minerals = 2000
			energy = 2000
		}
	}
}

# XuraCorp Destroyed
country_event = {
	id = leviathans.142
	title = "leviathans.141"
	desc = {
		text = leviathans.142.a.desc
		trigger = {
			NOT = {
				has_relation_flag = { 
					who = FROM
					flag = xuracorp_trade 
				}
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.142.b.desc
		trigger = {
			NOT = { 
				has_relation_flag = { 
					who = FROM
					flag = xuracorp_trade 
				}
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	desc = {
		text = leviathans.142.c.desc
		trigger = {
			has_relation_flag = { 
				who = FROM
				flag = xuracorp_trade 
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.142.d.desc
		trigger = {
			has_relation_flag = { 
				who = FROM
				flag = xuracorp_trade 
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	picture = GFX_evt_exploding_ship
	location = event_target:trader_system
	show_sound = event_ship_explosion
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = xuracorp_destroyed
		remove_xuracorp_trades = yes
		remove_enclave_resource_trades = yes
		remove_relation_flag = {
			who = FROM
			flag = enclave_resource_trade 
		}
		remove_relation_flag = {
			who = FROM
			flag = xuracorp_trade 
		}
	}
	
	option = {
		name = "leviathans.142.a"
	}
}

# Riggans Destroyed
country_event = {
	id = leviathans.143
	title = "leviathans.141"
	desc = {
		text = leviathans.143.a.desc
		trigger = {
			NOT = {
				has_relation_flag = { 
					who = FROM
					flag = riggan_trade 
				}
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.143.b.desc
		trigger = {
			NOT = { 
				has_relation_flag = { 
					who = FROM
					flag = riggan_trade 
				}
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	desc = {
		text = leviathans.143.c.desc
		trigger = {
			has_relation_flag = { 
				who = FROM
				flag = riggan_trade 
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.143.d.desc
		trigger = {
			has_relation_flag = { 
				who = FROM
				flag = riggan_trade 
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	picture = GFX_evt_exploding_ship
	location = event_target:trader_system
	show_sound = event_ship_explosion
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = riggans_destroyed
		remove_riggan_trades = yes
		remove_enclave_resource_trades = yes
		remove_relation_flag = {
			who = FROM
			flag = enclave_resource_trade 
		}
		remove_relation_flag = {
			who = FROM
			flag = riggan_trade 
		}
	}
	
	option = {
		name = "leviathans.143.a"
	}
}

# Muutagans Destroyed
country_event = {
	id = leviathans.144
	title = "leviathans.141"
	desc = {
		text = leviathans.144.a.desc
		trigger = {
			NOT = {
				has_relation_flag = { 
					who = FROM
					flag = muutagan_trade 
				}
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.144.b.desc
		trigger = {
			NOT = { 
				has_relation_flag = { 
					who = FROM
					flag = muutagan_trade 
				}
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	desc = {
		text = leviathans.144.c.desc
		trigger = {
			has_relation_flag = { 
				who = FROM
				flag = muutagan_trade 
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.144.d.desc
		trigger = {
			has_relation_flag = { 
				who = FROM
				flag = muutagan_trade 
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	picture = GFX_evt_exploding_ship
	location = event_target:trader_system
	show_sound = event_ship_explosion
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = muutagans_destroyed
		remove_muutagan_trades = yes
		remove_enclave_resource_trades = yes
		remove_relation_flag = {
			who = FROM
			flag = enclave_resource_trade 
		}
		remove_relation_flag = {
			who = FROM
			flag = muutagan_trade 
		}
	}
	
	option = {
		name = "leviathans.144.a"
	}
}

### Artist Troupe ###
# Artists
country_event = {
	id = leviathans.300
	title = leviathans.300.name
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				artist_enclave_diplomacy_continued = { text = leviathans.300.desc.continued }
				recently_purchased_art = { text = leviathans.302.a.reply }
				recently_purchased_ministry = { text = leviathans.316.a.reply }
				recently_purchased_patron = { text = leviathans.304.a.reply }
				recently_purchased_festival = { text = leviathans.303.a.reply }
				default = { text = leviathans.300.desc }
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}
	
	trigger = {
		OR = {
			OR = {
				has_country_flag = artist_enclave_diplomacy_continued
				NOT = { has_country_flag = artist_enclave_diplomacy_engaged }
			}
			has_country_flag = recently_purchased_art
			has_country_flag = recently_purchased_ministry
			has_country_flag = recently_purchased_patron
			has_country_flag = recently_purchased_festival
		}
		NOT = {	has_country_flag = enclave_artist_ignores }
	}

	immediate = {
		save_event_target_as = my_country
		set_country_flag = artist_enclave_diplomacy_engaged
	}

	option = {
		name = leviathans.300.a
		trigger = {
			check_variable = {
				which = artist_monument_purchased
				value < 5
			}
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
			country_event = { id = leviathans.302 }
		}
	}
	
	option = {
		name = leviathans.300.a
		response_text = leviathans.300.a.reply
		is_dialog_only = yes
		trigger = {
			check_variable = {
				which = artist_monument_purchased
				value = 5
			}
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
	}
	option = {
		name = leviathans.300.b
		trigger = {
			NOT = { has_modifier = enclave_artist_patron }
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
		hidden_effect = {
			country_event = { id = leviathans.304 }
		}
	}
	#option = {
	#	name = leviathans.300.b.stop
	#	response_text = leviathans.300.b.reply
	#	trigger = {
	#		has_modifier = enclave_artist_patron
	#		NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = #civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }#
	#	}#
	#	c#ustom_tooltip = opinion-5#
	#	c#ustom_tooltip = leviathans.300.b.stop.tooltip#
	#	r#emove_modifier = enclave_artist_patron#
	#	h#idden_effect = {#
	#	#	remove_countr#y_flag = artist_enclave_diplomacy_engaged#
	#	#	remove_countr#y_flag = artist_patron#
	#	#	set_country_f#lag = enclave_stopped_#patronage#
	#	#	event_target:#artist_enclave_country# = {#
	#	#		add_trust# = {#
	#	#			who =# roo#t#
	#	#			amoun#t = #-5#
	#	#		}#
	#		}#
	#	}
	#}
	option = {
		name = leviathans.300.c
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = artist_festival_purchased
				has_ethic = ethic_gestalt_consciousness
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.300.c.allow
				NOT = {
					has_country_flag = artist_festival_purchased
				}
				event_target:artist_enclave_country = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
			country_event = { id = leviathans.303 }
		}
	}
	option = {
		name = leviathans.300.c
		trigger = {
			has_country_flag = artist_festival_purchased
			NOR = { 
				has_valid_civic = civic_fanatic_purifiers
				has_authority = auth_hive_mind
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.300.c.outofstock
				NOT = {
					has_country_flag = artist_festival_purchased
				}
			}
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
			country_event = { id = leviathans.303 }
		}
	}
	option = {
		name = leviathans.300.d
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		is_dialog_only = yes
		response_text = leviathans.300.d.reply
	}
	# For those who have declined offer to build ministry of culture
	option = {
		name = leviathans.300.f
		trigger = {
			has_country_flag = enclave_artist_patron_event_1
			NOR = { 
				has_valid_civic = civic_fanatic_purifiers 
				has_valid_civic = civic_hive_devouring_swarm 
				has_valid_civic = civic_machine_terminator 
				has_country_flag = artist_building_patron
				has_country_flag = built_one_ministry
			}
			# former .316 trigger
			exists = event_target:artist_enclave_country
			has_modifier = enclave_artist_patron
			has_country_flag = artist_patron
			NOR = {
				has_country_flag = enclave_stopped_patronage
				has_country_flag = enclave_artist_ignores
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.316 }
		}
	}
	option = { # Art College
		name = leviathans.300.g
		trigger = {
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
			NOT = {
				event_target:artist_enclave_country = {
					has_country_flag = art_college@root
				}
			}
			any_system_within_border = {
				has_star_flag = enclave
				any_ship_in_system = {
					exists = owner
					owner = {
						is_same_value = event_target:artist_enclave_country
					}
				}
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.300.g.opinion
				event_target:artist_enclave_country = {
					trust = { 
						who = root
						value >= 50
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.340 }
		}
	}
	option = {
		name = GOODBYE
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
		}
	}

	option = {
		name = SCUM
		trigger = { has_valid_civic = civic_fanatic_purifiers }
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
		}
	}
	
	option = {
		name = TASTY
		trigger = { has_valid_civic = civic_hive_devouring_swarm }
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
		}
	}

	option = {
		name = EXTERMINATE
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
		}
	}

	#after = {
	#	hidden_effect = {
	#		remove_country_flag = artist_enclave_diplomacy_engaged
	#		remove_country_flag = artist_enclave_diplomacy_continued
	#		remove_country_flag = recently_purchased_art
	#		remove_country_flag = recently_purchased_ministry
	#		remove_country_flag = recently_purchased_patron
	#		remove_country_flag = recently_purchased_festival
	#	}
	#}
}

#Festival Event Trigger
country_event = {
	id = leviathans.309
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			10 = {
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_fanatic_materialist
						has_ethic = ethic_materialist
					}
				}
				country_event = { id = leviathans.310 days = 250 random = 25 }
			}
			10 = {
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_fanatic_xenophile
						has_ethic = ethic_xenophile
						has_ethic = ethic_fanatic_pacifist
						has_ethic = ethic_pacifist
					}
				}
				country_event = { id = leviathans.311 days = 150 random = 25 }
			}
			5 = {
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_fanatic_xenophobe
						has_ethic = ethic_xenophobe
						has_ethic = ethic_fanatic_materialist
						has_ethic = ethic_materialist
					}
				}
				country_event = { id = leviathans.312 days = 300 random = 50 }
			}
			10 = {
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_fanatic_xenophile
						has_ethic = ethic_xenophile
						has_ethic = ethic_fanatic_pacifist
						has_ethic = ethic_pacifist
					}
				}
				modifier = {
					factor = 0.25
					has_megacorp = yes
					OR = {
						has_ethic = ethic_fanatic_xenophobe
						has_ethic = ethic_xenophobe
					}
				}
				country_event = { id = spaceleviathans.100 days = 200 random = 100 }
			}
			10 = {
				capital_scope = {
					planet_event = { id = spaceleviathans.102 days = 250 random = 100 }
				}
			}
			55 = { }
		}
	}
}

#Patron Event Trigger
country_event = {
	id = leviathans.320
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
			has_country_flag = artist_patron_timer
		}
	}

	immediate = {
		set_timed_country_flag = { flag = artist_patron_timer days = 40 }
		random_list = {
			# Newsletter: Generic
			25 = {
				modifier = {
					factor = 2
					NOT = { has_country_flag = enclave_artist_patron_events }
				}
				modifier = {
					factor = 0
					OR = {
						NOT = { has_country_flag = artist_patron }
						has_country_flag = unsubscribed_from_newsletter
						check_variable = {
							which = artist_newsletter
							value > 6
						}
					}
				}
				country_event = { id = leviathans.321 days = 500 random = 1000 }
			}
			# Ministry of Culture
			20 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_1
						NOT = { has_country_flag = artist_patron }
					}
				}
				country_event = { id = leviathans.322 days = 500 random = 1000 }
			}
			# Lackluster Update
			20 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_2
						NOT = { has_country_flag = artist_patron }
					}
				}
				country_event = { id = leviathans.323 days = 500 random = 1000 }
			}
			# Broken Artistry
			20 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_3
						NOT = { has_country_flag = artist_patron }
					}
				}
				country_event = { id = leviathans.324 days = 500 random = 1000 }
			}
			# Magnum Opus
			15 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_4_mod
						NOT = { has_country_flag = artist_patron }
						AND = {
							NOT = { has_country_flag = enclave_artist_patron_event_2 }
							NOT = { has_country_flag = enclave_artist_patron_event_3 }
						}
					}
				}
				country_event = { id = spaceleviathans.120 days = 500 random = 1000 }
			}
			# Newsletter: Death of an Artist
			10 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_5_mod
						has_country_flag = unsubscribed_from_newsletter
						NOT = { has_country_flag = artist_patron }
						NOT = {
							check_variable = {
								which = artist_newsletter
								value > 4
							}
						}
					}
				}
				country_event = { id = spaceleviathans.121 days = 500 random = 1000 }
			}
			# Progress on Unity Buildings
			10 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_6_mod
						NOT = { has_country_flag = artist_patron }
						NOT = { has_country_flag = enclave_artist_patron_events }
						AND = {
							OR = {
								is_regular_empire = yes
								is_machine_empire = yes
								is_hive_empire = yes
							}
							is_spiritualist = no
							has_technology = tech_autocurating_vault
						}
						AND = {
							is_spiritualist = yes
							has_technology = tech_transcendent_faith
						}
					}
				}
				modifier = {
					factor = 0.5
					is_xenophobe = yes
				}
				country_event = { id = spaceleviathans.130 days = 500 random = 1000 }
			}
			# Advances in Holograms
			15 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_7_mod
						NOT = { has_country_flag = artist_patron }
						NOT = {
							check_variable = {
								which = artist_newsletter
								value > 6
							}
						}
					}
				}
				country_event = { id = spaceleviathans.131 days = 500 random = 1000 }
			}
			# Nothing Happens
			30 = {
				modifier = {
					factor = 0.20
					NOT = { has_country_flag = enclave_artist_patron_events }
				}
				modifier = {
					factor = 1.10
					has_country_flag = enclave_artist_patron_event_1
				}
				modifier = {
					factor = 1.10
					has_country_flag = enclave_artist_patron_event_2
				}
				modifier = {
					factor = 1.10
					has_country_flag = enclave_artist_patron_event_3
				}
				modifier = {
					factor = 1.10
					has_country_flag = enclave_artist_patron_event_4_mod
				}
				modifier = {
					factor = 1.10
					has_country_flag = enclave_artist_patron_event_6_mod
				}
				modifier = {
					factor = 1.10
					has_country_flag = enclave_artist_patron_event_7_mod
				}
				#DO NOTHING
			}
		}
	}
}

#Patron Newsletter
country_event = {
	id = leviathans.321
	title = leviathans.321.name
	desc = {
		trigger = {
			text = "leviathans.321.desc"
			text = "newline"
			success_text = {
				text = "leviathans.321.desc.a"
				check_variable = {
					which = artist_newsletter
					value = 1
				}
			}
			success_text = {
				text = "leviathans.321.desc.b"
				check_variable = {
					which = artist_newsletter
					value = 2
				}
			}
			success_text = {
				text = "leviathans.321.desc.c"
				check_variable = {
					which = artist_newsletter
					value = 3
				}
			}
			success_text = {
				text = "leviathans.321.desc.d"
				check_variable = {
					which = artist_newsletter
					value = 4
				}
			}
			success_text = {
				text = "leviathans.321.desc.e"
				check_variable = {
					which = artist_newsletter
					value = 5
				}
			}
			success_text = {
				text = "leviathans.321.desc.f"
				check_variable = {
					which = artist_newsletter
					value = 6
				}
			}
			success_text = {
				text = "leviathans.321.desc.g"
				check_variable = {
					which = artist_newsletter
					value = 7
				}
			}
		}
	}
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	is_triggered_only = yes
	
	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
		}
		check_variable = {
			which = artist_newsletter
			value < 7
		}
	}

	immediate = {
		set_country_flag = enclave_artist_patron_events
		if = {
			limit = {
				check_variable = {
					which = artist_newsletter
					value < 1
				}
			}
			set_variable = {
				which = artist_newsletter
				value = 1
			}
		}
		else = {
			change_variable = {
				which = artist_newsletter
				value = 1
			}
		}
		random_system = {
			limit = {
				any_system_planet = {
					has_planet_flag = guardians_artists_planet
				}
				root = {
					intel_level = {
						level > none
						system = prev
					}
				}
			}
			save_event_target_as = this_planet
		}
	}

	option = {
		name = leviathans.321.a
		#response_text = leviathans.321.a.reply
		add_resource = {
			energy = -500
			influence = 50
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 500 }
		}
	}
	option = {
		name = leviathans.321.c
		#response_text = leviathans.321.c.reply
		hidden_effect = {
			country_event = { id = leviathans.320 days = 60 random = 30 }
		}
	}	
	option = {
		name = leviathans.321.b
		trigger = { is_ai = no }
		#response_text = leviathans.321.b.reply
		hidden_effect = {
			set_country_flag = unsubscribed_from_newsletter
		}
		hidden_effect = {
			country_event = { id = leviathans.320 days = 60 random = 30 }
		}
	}
}

#Patron commission
country_event = {
	id = leviathans.322
	title = leviathans.322.name
	desc = leviathans.322.desc
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	is_triggered_only = yes
	
	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
			has_country_flag = artist_building_patron
		}
	}

	immediate = {
		set_country_flag = enclave_artist_patron_events
		set_country_flag = enclave_artist_patron_event_1
		random_system = {
			limit = {
				any_system_planet = {
					has_planet_flag = guardians_artists_planet
				}
				root = {
					intel_level = {
						level > none
						system = prev
					}
				}
			}
			save_event_target_as = this_planet
		}
	}
	option = {
		name = DEAL
		IF = {
			limit = { NOT = { has_ethic = ethic_gestalt_consciousness } }
			custom_tooltip = leviathans.322.a.tooltip.mod
		}
		ELSE = { custom_tooltip = leviathans.322.a.tooltip.gesta.mod }
		response_text = leviathans.316.a.reply
		allow = {
			NOT = { resource_stockpile_compare = { resource = energy value < 2000 } }
		}
		hidden_effect = {
			add_resource = { energy = -2000 }
			set_country_flag = artist_building_patron
		}
		hidden_effect = {
			country_event = { id = leviathans.320 days = 60 random = 30 }
		}
	}
	option = {
		name = TOOPOOR
		trigger = {
			resource_stockpile_compare = { resource = energy value < 2000 }
		}
		hidden_effect = {
			country_event = { id = leviathans.320 days = 60 random = 30 }
		}
	}
	option = {
		name = NODEAL
		trigger = {
			NOT = { resource_stockpile_compare = { resource = energy value < 2000 } }
		}
		hidden_effect = {
			country_event = { id = leviathans.320 days = 60 random = 30 }
		}
	}
}

#I became a patron and all I got was this t-shirt
country_event = {
	id = leviathans.323
	title = leviathans.323.name
	desc = leviathans.323.desc
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	is_triggered_only = yes
	
	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
		}
	}

	immediate = {
		set_country_flag = enclave_artist_patron_events
		set_country_flag = enclave_artist_patron_event_2
		random_system = {
			limit = {
				any_system_planet = {
					has_planet_flag = guardians_artists_planet
				}
				root = {
					intel_level = {
						level > none
						system = prev
					}
				}
			}
			save_event_target_as = this_planet
		}
	}
	option = {
		name = leviathans.323.a
		custom_tooltip = opinion10
		response_text = leviathans.323.a.reply
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			country_event = { id = leviathans.320 days = 100 random = 25 }
		}
	}
	option = {
		name = leviathans.323.b
		add_resource = { energy = 1000 }
		custom_tooltip = opinion-3
		remove_modifier = enclave_artist_patron
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = -3
				}
			}
		}
		response_text = leviathans.323.b.reply
	}
}
#Artist asks if you want some resources
country_event = {
	id = leviathans.324
	title = leviathans.324.name
	desc = leviathans.324.desc
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	is_triggered_only = yes
	
	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
		}
	}

	immediate = {
		set_country_flag = enclave_artist_patron_events
		set_country_flag = enclave_artist_patron_event_3
		random_system = {
			limit = {
				any_system_planet = {
					has_planet_flag = guardians_artists_planet
				}
				root = {
					intel_level = {
						level > none
						system = prev
					}
				}
			}
			save_event_target_as = this_planet
		}
	}
	option = {
		name = leviathans.324.a
		add_resource = { minerals = 500 }
		response_text = leviathans.324.a.reply
		hidden_effect = {
			country_event = { id = leviathans.320 days = 60 random = 30 }
		}
	}
	option = {
		name = leviathans.324.b
		add_resource = { influence = 50 }
		response_text = leviathans.324.b.reply
		hidden_effect = {
			country_event = { id = leviathans.320 days = 60 random = 30 }
		}
	}
}

# Artist Troupe Attacked
country_event = {
	id = leviathans.330
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		from = {
			has_country_flag = artist_enclave_country
		}
	}

	immediate = {
		if = {
			limit = {
				OR = {
					has_modifier = enclave_artist_patron
					has_country_flag = artist_patron
				}
			}
			remove_modifier = enclave_artist_patron
			remove_country_flag = artist_patron
		}
		if = {
			limit = {
				NOT = { has_country_flag = enclave_artist_ignores }
			}
			set_country_flag = enclave_artist_ignores
		}
		# send news letter about attack to all patrons
		if = {
			limit = { NOT = { has_global_flag = recent_artist_enclave_attack } }
			set_timed_global_flag = { flag = recent_artist_enclave_attack days = 360 } # one year cooldown
			every_country = {
				limit = {
					NOR = {
						has_country_flag = enclave_stopped_patronage
						has_country_flag = enclave_artist_ignores
						has_country_flag = unsubscribed_from_newsletter
					}
				}
				country_event = { id = spaceleviathans.122 days = 300 random = 60 }
			}
		}
	}
}

# An artist station has been destroyed
country_event = {
	id = leviathans.332
	title = leviathans.300.name
	desc = leviathans.332.desc
	picture = GFX_evt_exploding_ship
	show_sound = event_structural_collapse
	location = event_target:destroyed_station_location

	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { NOT = { has_global_flag = artist_enclave_destoyed_station } }
			set_timed_global_flag = { flag = artist_enclave_destoyed_station days = 360 }
		}
		if = {
			limit = { has_global_flag = one_artist_enclave_destroyed }
			set_global_flag = two_artist_enclave_destroyed
		}
		else = {
			set_global_flag = one_artist_enclave_destroyed
		}
	}

	option = {
		name = WORRYING
		trigger = {
			NOT = { has_country_flag = enclave_artist_ignores }
		}
	}
	option = {
		name = OK
		trigger = {
			has_country_flag = enclave_artist_ignores
		}
	}
}

### Curator Order ###

# Curator Hire Scientist Menu
country_event = {
	id = leviathans.590
	title = leviathans.590.name
	desc = {
		trigger = { NOT = { has_country_flag = curator_archon_permitted } }
		text = leviathans.590.desc
	}
	desc = {
		trigger = { has_country_flag = curator_archon_permitted }
		text = acot_diplo.archon.desc
	}
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		event_target:curators = {
			owner_species = { save_event_target_as = curator_species }
		}
		if = {
			limit = { NOT = { exists = event_target:acot_curator_species_1 } }
			event_target:curators = {
				owner_species = { save_event_target_as = acot_curator_species_1 }
			}
		}
		if = {
			limit = { NOT = { exists = event_target:acot_curator_species_2 } }
			event_target:curators = {
				owner_species = { save_event_target_as = acot_curator_species_2 }
			}
		}
		if = {
			limit = { NOT = { exists = event_target:acot_curator_species_3 } }
			event_target:curators = {
				owner_species = { save_event_target_as = acot_curator_species_3 }
			}
		}
		if = {
			limit = { NOT = { exists = event_target:acot_curator_species_4 } }
			event_target:curators = {
				owner_species = { save_event_target_as = acot_curator_species_4 }
			}
		}
		if = {
			limit = { NOT = { exists = event_target:acot_curator_species_5 } }
			event_target:curators = {
				owner_species = { save_event_target_as = acot_curator_species_5 }
			}
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.590.a
		response_text = leviathans.590.a.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			NOT = {
				has_country_flag = curator_archon_permitted
			}
		}
		allow = { 
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
			custom_tooltip = {
				fail_text = acot_curator_hire_scientist_fail
				NOT = { has_country_flag = curator_scientist_delay }
			}
		}
		set_timed_country_flag = {
			flag = curator_scientist_delay
			years = 10
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion20
		hidden_effect = {
			set_country_flag = curator_scientist_recruited
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			random_list = {
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_1
						name = "NAME_Professor_Zarg"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 41
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_2
						name = "NAME_The_Mentat"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 45
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_3
						name = "NAME_Kix_the_Brilliant"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 43
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_4
						name = "NAME_Sensei_Borkaz"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 47
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_5
						name = "NAME_Doctor_Xib"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 42
					}
				}
			}
		}
	}

	option = {
		name =   acot_diplo.archon.a
		response_text =  acot_diplo.archon.a.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			has_country_flag = curator_archon_permitted
			has_global_flag = acot_activated
		}
		allow = { 
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
			custom_tooltip = {
				fail_text = acot_curator_hire_scientist_fail
				NOT = { has_country_flag = curator_scientist_delay }
			}
		}
		set_timed_country_flag = {
			flag = curator_scientist_delay
			years = 10
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion20
		hidden_effect = {
			set_country_flag = curator_scientist_recruited
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			random_list = {
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_1
						name = "Curator Professor"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 41
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_2
						name = "Curator Professor"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 45
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_3
						name = "Curator Professor"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 43
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_4
						name = "Curator Professor"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 47
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_5
						name = "Curator Professor"
						skill = 5
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_ruler_erudite
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 42
					}
				}
			}
		}
	}

	option = {
		name =   acot_diplo.archon.b
		response_text =  acot_diplo.archon.b.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			has_country_flag = curator_archon_permitted
			has_global_flag = acot_activated
		}
		allow = { 
			resource_stockpile_compare = { resource = energy value >= 100000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
			custom_tooltip = {
				fail_text = acot_curator_hire_archon_fail
				NOT = { has_country_flag = curator_archon_delay }
			}
		}
		set_timed_country_flag = {
			flag = curator_archon_delay
			years = 30
		}
		add_resource = { energy = -100000 }
		hidden_effect = {
			set_country_flag = curator_scientist_recruited
			random_list = {
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_1
						name = "Curator Archon"
						skill = 10
						immortal = yes
						leader_age_min = 100000
						leader_age_max = 500000
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_acot_curator_archon
							trait = leader_trait_scientist_erudite
							trait = leader_trait_scientist_cyborg
							trait = leader_trait_scientist_psionic
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_2
						name = "Curator Archon"
						skill = 10
						immortal = yes
						leader_age_min = 100000
						leader_age_max = 500000
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_acot_curator_archon
							trait = leader_trait_scientist_erudite
							trait = leader_trait_scientist_cyborg
							trait = leader_trait_scientist_psionic
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_3
						name = "Curator Archon"
						skill = 10
						immortal = yes
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_acot_curator_archon
							trait = leader_trait_scientist_erudite
							trait = leader_trait_scientist_cyborg
							trait = leader_trait_scientist_psionic
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_4
						name = "Curator Archon"
						skill = 10
						immortal = yes
						leader_age_min = 100000
						leader_age_max = 500000
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_acot_curator_archon
							trait = leader_trait_scientist_erudite
							trait = leader_trait_scientist_cyborg
							trait = leader_trait_scientist_psionic
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:acot_curator_species_5
						name = "Curator Archon"
						skill = 10
						immortal = yes
						leader_age_min = 100000
						leader_age_max = 500000
						traits = {
							trait = leader_trait_curator
							trait = leader_trait_acot_curator_archon
							trait = leader_trait_scientist_erudite
							trait = leader_trait_scientist_cyborg
							trait = leader_trait_scientist_psionic
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
				}
			}
		}
	}

	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		custom_gui = "enclave_curator_option"
		default_hide_option = yes
	}
}

#############################################################

# wraith won't be discovered past the midgame
event = {
	id = leviathans.20101
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		any_system = {
			any_system_planet = { has_planet_flag = guardians_wraith_pulsar }
		}
	}

	immediate = {
		# do nothing
	}
}

### WRAITH ###
# First scan of the neutron star, sets Wraith spawn timer
ship_event = {
	id = leviathans.2010
	title = "leviathans.2010.name"
	desc = {
		text = leviathans.2010.desc
		trigger = {
			owner = { NOT = { has_ethic = ethic_gestalt_consciousness } }
		}
	}
	desc = {
		text = leviathans.2010.desc.gesta
		trigger = {
			owner = { has_ethic = ethic_gestalt_consciousness }
		}
	}
	picture = GFX_evt_star_pulsar
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes

	trigger = {
		from = { has_planet_flag = guardians_wraith_pulsar }
	}

	immediate = {
		from = {
			remove_planet_flag = guardians_wraith_pulsar
			add_modifier = {
				modifier = germinating_wraith
				days = -1
			}
		}
		if = {
			limit = { mid_game_years_passed >= 0 }
			from = {
				planet_event = { id = spaceleviathans.400 days = 23400 random = 3600 }
			}
		}
	}

	option = {
		name = leviathans.2010.a
		custom_tooltip = leviathans.2010.c
	}
}

# 3100 AUTOMATED DREADNOUGHT

# Dreadnought Disabled (HIDDEN)
country_event = {
	id = leviathans.3101
	hide_window = yes
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_country_type = guardian_dreadnought
		has_country_flag = automated_dreadnought_country
		FROMFROM = { is_ship_size = npc_warship_01 }
	}
	
	immediate = {
		FROMFROM = {
			solar_system = { save_event_target_as = guardians_dreadnought_system }
			create_ambient_object = {
				type = "dreadnought_object"
				location = THIS
			}
			last_created_ambient_object = { save_global_event_target_as = disabled_dreadnought_object }
			create_ambient_object = {
				type = "large_debris_object"
				location = THIS
			}
			last_created_ambient_object = { set_ambient_object_flag = dreadnought_debris }
		}
		FROM = {
			country_event = { id = leviathans.3102 }
		}
		destroy_country = yes
		every_country = {
			limit = { 
				OR = { is_country_type = default is_country_type = ascended_empire is_country_type = lost_empire }
				has_modifier = automated_dreadnought_weak_points
			}
			remove_modifier = "automated_dreadnought_weak_points"
		}
		every_country = {
			limit = {
				OR = { is_country_type = default is_country_type = ascended_empire is_country_type = lost_empire }
				has_event_chain = curator_poi_chain
				event_target:guardians_dreadnought_system = {
					is_point_of_interest = {
						id = curator_poi_dreadnought
						event_chain = curator_poi_chain
						owner = prev
					}
				}
			}
			remove_point_of_interest = curator_poi_dreadnought
			end_curator_chain = yes
		}
	}
}

# 3200 HIVE ASTEROID

# Hivers Destroyed (HIDDEN)
country_event = {
	id = leviathans.3203
	hide_window = yes
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_country_type = guardian_hiver
		has_country_flag = hive_country
		count_owned_ship = {
			limit = { is_ship_size = hive_asteroid }
			count < 1 # count_owned_ships no longer counts dead ships
		}
		FROM = { 
			has_country_flag = provoked_hivers 
		}
	}
	
	immediate = {
		random_system = {
			limit = { has_star_flag = guardians_hive_system }
			save_event_target_as = hive_system
			set_star_flag = hivers_defeated
		}
		create_ambient_object = {
			type = "dormant_hive_base_2_object"
		}
		last_created_ambient_object = {
			set_location = FROMFROM
			set_ambient_object_flag = boardable_hive_asteroid
			save_event_target_as = boardable_hive_asteroid
		}
		FROM = {
			country_event = { id = leviathans.3204 }
		}
		every_country = {
			limit = { 
				OR = { is_country_type = default is_country_type = ascended_empire is_country_type = lost_empire }
				has_modifier = asteroid_hive_weak_points
			}
			remove_modifier = "asteroid_hive_weak_points"
		}
		every_country = {
			limit = {
				OR = { is_country_type = default is_country_type = ascended_empire is_country_type = lost_empire }
				has_event_chain = curator_poi_chain
				event_target:hive_system = {
					is_point_of_interest = {
						id = curator_poi_hiver
						event_chain = curator_poi_chain
						owner = prev
					}
				}
			}
			remove_point_of_interest = curator_poi_hiver
			end_curator_chain = yes
		}
	}
}