namespace = action

# planets in mixed-ownership systems fall to starbase owner
# NOTE: modified to exclude the Beep-Boops - this was simpler than editing diplomatic stance policies to allow a custom country type
# triggered by on_monthly_pulse
event = {
	id = action.85
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		any_country = {
			NOR = { is_country_type = primitive has_country_flag = is_peepboops }
			any_owned_planet = {
				exists = starbase
				starbase = {
					owner = {
						NOR = {
							is_same_value = prevprevprev
							is_at_war_with = prevprevprev
						}
					}
				}
			}
		}
	}

	immediate = {
		every_galaxy_planet = {
			limit = {
				exists = owner
				owner = {
					OR = {
						is_country_type = default
						is_country_type = fallen_empire
						is_country_type = awakened_fallen_empire
					}
				}
				exists = starbase
				starbase = {
					exists = owner
					owner = {
						OR = {
							is_country_type = default
							is_country_type = fallen_empire
							is_country_type = awakened_fallen_empire
						}
						NOR = {
							is_same_value = prevprev.owner
							is_at_war_with = prevprev.owner
						}
						NOT = {
							has_active_event = {
								preftl.180 #event to decide fate of pre-ftl civ
							}
						}
					}
				}
			}
			planet_event = { id = action.86 } # planet flips to starbase owner
		}
	}
}