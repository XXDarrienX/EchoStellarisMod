#Lithoid Supremacy Events
namespace = lithoidsupremacy

#Event 1: Geode world DM deficit consequences
country_event = {
	id = lithoidsupremacy.1
	hide_window = yes
	is_triggered_only = yes

	#Triggers on DM deficit (has 0 of resouce and gain is negative)
	trigger = {
		exists = owner
		owner = { has_origin = origin_geode_world }
		has_resource = { type = sr_dark_matter amount = 0 }
		has_monthly_income = { resource = sr_dark_matter  value < 0 }
	}

	#Causes 5 monthly devastation to owned geode worlds (That are not the Origin world)
	immediate = {
		every_owned_planet = {
			limit = {
				is_planet_class = pc_geode
				has_deposit = d_geode_world_maintenance
			}
			add_planet_devastation = 5
		}
	}
}

#Event 2: Geode World Origin Setup
planet_event = {
	id = lithoidsupremacy.2
	is_triggered_only = yes
	hide_window = yes

	pre_triggers = {
		has_owner = yes
	}

	#Checks owner has the correct origin
	trigger = {
		owner = { has_origin = origin_geode_world }
	}
	
	immediate = {
		#Set planet size as 25 (Boosted to 32 with the deposit later)
		set_planet_size = 25
		
		#Create the ambient shattered section
		create_ambient_object = {
			location = this
			type = "lithoid_supremacy_geode_object"

			use_3d_location= yes

			entity_offset = 0
			entity_offset_angle = 0
			entity_offset_height = 0
			base_angle_towards = star
			entity_face_object = star

			entity_scale_to_size = no #yes
			scale = 16
			#0.5 by default
			#0.3 is under planet mesh
		}
		
		#Add Modifier
		add_modifier = { modifier = geode_world days = -1 }

		#Add Deposits
		add_deposit = d_expanded_lithosphere
		add_deposit = d_geode_world_origin_maintenace

		#add_district = district_generator
		#add_district = district_farming
		#add_district = district_mining
		
		#give the rare crystal tech
		owner = {
			give_technology = { message = no tech = tech_mine_rare_crystals }
		}
	}
}

#Event 3: Meteor ship Buff [Part 1]
planet_event = {
	id = lithoidsupremacy.3
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = FROM
		exists = owner

		FROM = { is_ship_size = lithoid_colonizer }
		owner = { has_origin = origin_lithoid }
		owner = { has_technology = tech_advanced_meteor_ship }

		#NOT = { has_modifier = lithoid_crater } #Planet will immediately get this modifier
	}

	immediate = {
		add_deposit = d_buried_lithoids
		set_planet_flag = advanced_meteor_colonization
	}
}

#Event 4: Meteor ship Buff [Part 2]
planet_event = {
	id = lithoidsupremacy.4
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		planet = {
			has_planet_flag = advanced_meteor_colonization
		}
	}

	immediate = {
		create_pop = { species = owner }
		remove_planet_flag = advanced_meteor_colonization
	}
}