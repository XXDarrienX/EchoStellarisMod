namespace = mem_orila_primitives

#setup event for primitive systems habitable (5 - uniques) and destroyed (5)
# this event will not be fired. the effect is called in mem_vazurans.1 to make use of its system modifications
event = {
	id = mem_orila_primitives.1
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		mem_gamestart_orila_primitive_setup = yes
	}
}

# Triggers event when each country first sends a ship into the system (once per country)
# Scope = Ship
# From = System
# FromFrom = Country
# If there is an active presence of guardians, then diplomatic contact follows in the next event
ship_event = {
	id = mem_orila_primitives.10
	title = mem_orila_primitives.10.name
	desc = mem_orila_primitives.10.desc
	picture = GFX_evt_mem_placeholder
	show_sound =  event_ship_bridge
	is_triggered_only = yes

	trigger = {
		from = {
			has_star_flag = mem_orila_primitive_system
			NOT = {
				has_star_flag = mem_orila_primitive_system_destroyed
			}
		}
	}

	option = {
		name = ONSCREEN
		hidden_effect = {
			owner = {
				country_event = { id = mem_orila_primitives.100 }
			}
		}
	}
}

# Triggers event when each country first sends a ship into the system (once per country)
# Scope = Ship
# From = System
# FromFrom = Country
# If there is no active presence of guardians, then story event follows in the next event
ship_event = {
	id = mem_orila_primitives.20
	title = mem_orila_primitives.20.name
	desc = { # haven't seen anything vazuran related so far
		text = mem_orila_primitives.20a.desc
		trigger = {
			exists = controller
			controller = {
				NOT = {
					has_country_flag = mem_vazuran_destroyed_planet_found
				}
			}
			from = {
				has_star_flag = mem_vazuran_destroyed_planet_system
			}
		}
	}
	desc = { # only seen another destroyed planet so far
		text = mem_orila_primitives.20b.desc
		trigger = {
			exists = controller
			controller = {
				NOT = {
					has_country_flag = mem_vazurans_met
				}
				has_country_flag = mem_vazuran_destroyed_planet_found
			}
			from = {
				has_star_flag = mem_vazuran_destroyed_planet_system
			}
		}
	}
	desc = { # already met the vazurans and seen a destroyed planet
		text = mem_orila_primitives.20c.desc
		trigger = {
			exists = controller
			controller = {
				has_country_flag = mem_vazurans_met
				has_country_flag = mem_vazuran_destroyed_planet_found
			}
			from = {
				has_star_flag = mem_vazuran_destroyed_planet_system
			}
		}
	}
	desc = { # system not related to vazurans
		text = mem_orila_primitives.20d.desc
		trigger = {
			from = {
				NOT = {
					has_star_flag = mem_vazuran_destroyed_planet_system
				}			
			}
		}
	}
	picture = GFX_evt_ruined_system
	show_sound =  event_ship_bridge
	is_triggered_only = yes

	trigger = {
		from = {
			has_star_flag = mem_orila_primitive_system_destroyed
		}
	}

	option = {
		name = WORRYING
		trigger = {
			from = {
				has_star_flag = mem_vazuran_destroyed_planet_system
			}
			controller = {
				NOT = {
					has_country_flag = mem_vazuran_destroyed_planet_found
				}
			}
		}
		solar_system = {
			random_system_planet = {
				limit = {
					has_planet_flag = mem_vazuran_destroyed_planet
				}
				enable_special_project = {
					name = MEM_VAZURANS_BROKEN_PLANET_INVESTIGATION
					location = this
					owner = root.controller
				}
			}
		}
		controller = {
			set_country_flag = mem_vazuran_destroyed_planet_found
		}
	}

	option = {
		name = WORRYING
		trigger = {
			from = {
				has_star_flag = mem_vazuran_destroyed_planet_system
			}
			controller = {
				has_country_flag = mem_vazuran_destroyed_planet_found
			}
		}
	}

	option = {
		name = INTERESTING
		trigger = {
			from = {
				NOT = {
					has_star_flag = mem_vazuran_destroyed_planet_system
				}				
			}
		}
	}
}

# correctly working AI
country_event = {
	id = mem_orila_primitives.100
	title = mem_orila_primitives.100.name
	desc = mem_orila_primitives.100.desc
	
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = mem_orila_room
		portrait = mem_Orila_holo
	}

	# Treaty?
	option = {
		name = mem_orila_primitives.100.a
		response_text = mem_orila_primitives.100.desc.a
		is_dialog_only = yes
	}

	# Senate?
	option = {
		name = mem_orila_primitives.100.b
		response_text = mem_orila_primitives.100.desc.b
		is_dialog_only = yes
	}

	# Builders?
	option = {
		name = mem_orila_primitives.100.c
		response_text = mem_orila_primitives.100.desc.c
		is_dialog_only = yes
		hidden_effect = {
			set_country_flag = mem_orila_primitive_system_q100c
		}
	}

	# Council?
	option = {
		name = mem_orila_primitives.100.d
		response_text = mem_orila_primitives.100.desc.d
		is_dialog_only = yes
		trigger = {
			has_country_flag = mem_orila_primitive_system_q100c
		}
		hidden_effect = {
			remove_country_flag = mem_orila_primitive_system_q100c
			set_country_flag = mem_orila_primitive_system_q100d
		}
	}

	# Contact? 1
	option = {
		name = mem_orila_primitives.100.e
		response_text = mem_orila_primitives.100.desc.e
		is_dialog_only = yes
		trigger = {
			has_country_flag = mem_orila_primitive_system_q100d
			exists = event_target:mem_orila_country
			NOT = {
				has_communications = event_target:mem_orila_country
			}
		}
		hidden_effect = {
			establish_communications = event_target:mem_orila_country
		}
	}

	# Contact? 2
	option = {
		name = mem_orila_primitives.100.e
		response_text = mem_orila_primitives.100.desc.f
		is_dialog_only = yes
		trigger = {
			has_country_flag = mem_orila_primitive_system_q100d
			NOT = {
				exists = event_target:mem_orila_country
			}
		}
	}

	# Bye
	option = {
		name = mem_orila_primitives.100.g
		response_text = mem_orila_primitives.100.desc.g
		hidden_effect = {
			remove_country_flag = mem_orila_primitive_system_q100c
		}
	}

	# Hack
	option = {
		name = mem_orila_primitives.100.h
		#response_text = mem_orila_primitives.100.desc.h
		trigger = {
			OR = {
				has_ascension_perk = ap_archaeoengineers
				has_ascension_perk = ap_enigmatic_engineering
				has_ascension_perk = ap_technological_ascendancy				
				has_tradition = tr_subterfuge_finish
			}
		}
		hidden_effect = {
			remove_country_flag = mem_orila_primitive_system_q100c
			#make engineering research project at system's sun
		}
	}
}

# malfunctioning AI
country_event = {
	id = mem_orila_primitives.110
	title = mem_orila_primitives.100.name
	desc = mem_orila_primitives.110.desc
	
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = mem_orila_room
		portrait = mem_Orila_holo_red_1
	}

	# Information?
	option = {
		name = mem_orila_primitives.110.a
		response_text = mem_orila_primitives.110.desc.a
		is_dialog_only = yes
	}

	# Offer support?
	option = {
		name = mem_orila_primitives.110.b
		response_text = mem_orila_primitives.110.desc.b
		is_dialog_only = yes
	}

	option = {
		name = mem_orila_primitives.100.c
		response_text = mem_orila_primitives.100.desc.c
		is_dialog_only = yes
		hidden_effect = {
			set_country_flag = mem_orila_primitive_system_q100c
		}
	}

	option = {
		name = mem_orila_primitives.100.d
		response_text = mem_orila_primitives.100.desc.d
		is_dialog_only = yes
		trigger = {
			has_country_flag = mem_orila_primitive_system_q100c
		}
		hidden_effect = {
			remove_country_flag = mem_orila_primitive_system_q100c
			set_country_flag = mem_orila_primitive_system_q100d
		}
	}

	option = {
		name = mem_orila_primitives.100.e
		response_text = mem_orila_primitives.100.desc.e
		is_dialog_only = yes
		trigger = {
			has_country_flag = mem_orila_primitive_system_q100d
			exists = event_target:mem_orila_country
			NOT = {
				has_communications = event_target:mem_orila_country
			}
		}
		hidden_effect = {
			establish_communications = event_target:mem_orila_country
		}
	}

	option = {
		name = mem_orila_primitives.100.e
		response_text = mem_orila_primitives.100.desc.f
		is_dialog_only = yes
		trigger = {
			has_country_flag = mem_orila_primitive_system_q100d
			NOT = {
				exists = event_target:mem_orila_country
			}
		}
	}

	option = {
		name = mem_orila_primitives.100.g
		response_text = mem_orila_primitives.100.desc.g
		hidden_effect = {
			remove_country_flag = mem_orila_primitive_system_q100c
		}
	}

	option = {
		name = mem_orila_primitives.100.h
		#response_text = mem_orila_primitives.100.desc.h
		trigger = {
			OR = {
				has_ascension_perk = ap_archaeoengineers
				has_ascension_perk = ap_enigmatic_engineering
				has_ascension_perk = ap_technological_ascendancy				
				has_tradition = tr_subterfuge_finish
			}
		}
		hidden_effect = {
			remove_country_flag = mem_orila_primitive_system_q100c
			#make engineering research project at system's sun
		}
	}
}

# Corrupted AI
country_event = {
	id = mem_orila_primitives.120
	title = mem_orila_primitives.100.name
	desc = mem_orila_primitives.120.desc
	
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = mem_orila_room
		portrait = mem_Orila_holo_red_1
	}

	option = {
		name = mem_orila_primitives.110.a
		response_text = mem_orila_primitives.110.desc.a
		is_dialog_only = yes
	}

	option = {
		name = mem_orila_primitives.100.b
		response_text = mem_orila_primitives.100.desc.b
		is_dialog_only = yes
	}

	option = {
		name = mem_orila_primitives.100.c
		response_text = mem_orila_primitives.100.desc.c
		is_dialog_only = yes
		hidden_effect = {
			set_country_flag = mem_orila_primitive_system_q100c
		}
	}

	option = {
		name = mem_orila_primitives.100.d
		response_text = mem_orila_primitives.100.desc.d
		is_dialog_only = yes
		trigger = {
			has_country_flag = mem_orila_primitive_system_q100c
		}
		hidden_effect = {
			remove_country_flag = mem_orila_primitive_system_q100c
			set_country_flag = mem_orila_primitive_system_q100d
		}
	}

	option = {
		name = mem_orila_primitives.100.e
		response_text = mem_orila_primitives.100.desc.e
		is_dialog_only = yes
		trigger = {
			has_country_flag = mem_orila_primitive_system_q100d
			exists = event_target:mem_orila_country
			NOT = {
				has_communications = event_target:mem_orila_country
			}
		}
		hidden_effect = {
			establish_communications = event_target:mem_orila_country
		}
	}

	option = {
		name = mem_orila_primitives.100.e
		response_text = mem_orila_primitives.100.desc.f
		is_dialog_only = yes
		trigger = {
			has_country_flag = mem_orila_primitive_system_q100d
			NOT = {
				exists = event_target:mem_orila_country
			}
		}
	}

	option = {
		name = mem_orila_primitives.100.g
		response_text = mem_orila_primitives.100.desc.g
		hidden_effect = {
			remove_country_flag = mem_orila_primitive_system_q100c
		}
	}

	option = {
		name = mem_orila_primitives.100.h
		#response_text = mem_orila_primitives.100.desc.h
		trigger = {
			OR = {
				has_ascension_perk = ap_archaeoengineers
				has_ascension_perk = ap_enigmatic_engineering
				has_ascension_perk = ap_technological_ascendancy				
				has_tradition = tr_subterfuge_finish
			}
		}
		hidden_effect = {
			remove_country_flag = mem_orila_primitive_system_q100c
			#make engineering research project at system's sun
		}
	}
}