	namespace = leviathans
	
# Curator Main Menu (Initial)
country_event = {
	id = leviathans.500
	title = leviathans.500.name
	desc = leviathans.500a.desc
	desc = leviathans.500b.desc
	desc = leviathans.500c.desc
	desc = leviathans.500d.desc
	desc = leviathans.500e.desc
	desc = leviathans.500f.desc
	desc = leviathans.500g.desc
	desc = leviathans.500h.desc
	desc = leviathans.500i.desc
	desc = leviathans.500j.desc
	desc = leviathans.500k.desc
	desc = leviathans.500l.desc
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"
	force_open = yes

	picture_event_data = {
		portrait = from
		room = enclave_curator_room
	}
	
	trigger = {
		from = {
			is_country_type = enclave
			has_country_flag = curator_enclave_country
		}
		NOT = { has_country_flag = curator_enclave_diplomacy_engaged }
		NOT = { has_country_flag = attacked_curators }
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		FROM = { save_event_target_as = curators }
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		trigger = { has_valid_civic = civic_fanatic_purifiers }
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}
	
	option = {
		name = TASTY
		trigger = { has_valid_civic = civic_hive_devouring_swarm }
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = EXTERMINATE
		trigger = { has_valid_civic = civic_machine_terminator }
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}	
	
	option = { # Research
		name = leviathans.500.b
		custom_gui = "enclave_curator_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.b.alreadyaided
				NOT = { has_modifier = curator_insight }
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.507 }
		}
	}
	
	option = { # Guardians
		name = leviathans.500.c
		custom_gui = "enclave_curator_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		hidden_effect = {
			country_event = { id = leviathans.508 }
		}
	}
	
	option = { # Hire Scientist
		name = leviathans.500.d
		custom_gui = "enclave_curator_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.d.opinion
				event_target:curators = {
					trust = { 
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = leviathans.500.d.alreadyrecruited
				NOT = {
					any_owned_leader = { has_trait = leader_trait_curator }
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.590 }
		}
	}
	
	option = { # Sell Intel
		name = leviathans.500.h
		custom_gui = "enclave_curator_option"
		trigger = {
			is_homicidal = no
			any_country = {
				valid_curators_intel_trade_target = yes
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.d.opinion
				event_target:curators = {
					trust = { 
						who = root
						value >= 50
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.599 }
		}
	}

	option = { # Think Tank
		name = leviathans.500.f
		custom_gui = "enclave_curator_option"
		trigger = { 
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
			NOT = {
				event_target:curators = { has_country_flag = think_tank@root }
			}
			any_system_within_border = {
				has_star_flag = enclave
				any_fleet_in_system = {
					exists = owner
					owner = {
						is_same_value = event_target:curators
					}
				}
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.d.opinion
				event_target:curators = {
					trust = { 
						who = root
						value >= 50
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.511 }
		}
	}
# Available after finishing Infinity Sphere chain
	option = {
		name = leviathans.500.g
		custom_gui = "enclave_curator_option"
		trigger = {
			has_country_flag = pantagruel
			has_country_flag = asked_about_infinity_machine
			NOT = { has_country_flag = offered_information }
		}
		hidden_effect = {
			country_event = { id = leviathans.4000 }
		}
	}

	# L-Cluster clue
	option = {
		name = distar.11500.a
		custom_gui = "enclave_curator_option"
		trigger = {
			has_event_chain = l_cluster_chain
			NOR = {
				is_homicidal = yes
				has_global_flag = l_cluster_opened
				has_completed_event_chain_counter = {
					event_chain = l_cluster_chain
					counter = clues
				}
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = distar.11500.a.tooltip.noclue
				NOT = { has_country_flag = curator_clue_purchased }
			}
		}
		hidden_effect = {
			country_event = { id = distar.11501 }
		}
	}

	option = {
		name = leviathans.500.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}
	#MOD BEGINS
	option = {
		name = distar.11500.mod
		custom_gui = "enclave_curator_option"
		trigger = {
			root = { has_origin = origin_shiva }
			NOR = {
				is_homicidal = yes
				has_country_flag = inquired_curators_about_shiva
			}
		}
		hidden_effect = {
			set_country_flag = inquired_curators_about_shiva
			country_event = { id = leviathans.69 }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
	}
}

#Inquire about Shivkonians
country_event = {
	id = leviathans.69
	title = leviathans.500.name
	desc = leviathans.69.desc
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"
	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}
	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}
	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}
	option = {
		name = leviathans.69.a
		custom_gui = "enclave_curator_option"
		add_resource = { energy = -1000 }
		create_point_of_interest = {
			id = shiva_system_poi
			name = shiva_system_poi_title
			desc = shiva_system_poi_desc
			event_chain = shiva_system_chain
			location = event_target:shiva_star
		}
	}
}

# Dragon Hoard event - Bones
country_event = {
	id = leviathans.661
	title = "leviathans.660.name"
	desc = "leviathans.660.desc"
	picture = GFX_evt_archaeological_dig
	location = from
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = leviathans.660.a
		add_research_option = tech_dragon_armor
		add_tech_progress = {
			tech = tech_dragon_armor
			progress = 0.9
		}
	}

	option = {
		name = leviathans.660.b
		add_monthly_resource_mult = {
			resource = minerals
			value = 36
			min = 100
			max = 4000
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = 30
			min = 1000
			max = 5000
		}		
	}
}

planet_event = {
	id = leviathans.662
	hide_window = yes

	mean_time_to_happen = {
		years = 1
	}

	trigger = {
		has_planet_flag = hoard_planet
		#has_deposit = d_guardian_dragon_hoard
		NOT = {
			has_planet_flag = deegged
		}
		has_mining_station = yes
		exists = controller
		controller = {
			is_country_type = default
		}
	}

	immediate = {
		set_timed_planet_flag = {
			flag = deegged
			days = 7200
		}
		controller = {
			country_event = { id = leviathans.663 }
		}
	}
}

# Egg incubated
planet_event = {
	id = leviathans.664
	title = leviathans.664.name
	desc = leviathans.664.desc
	picture = GFX_evt_space_dragon
	location = root
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	immediate = {
		create_fleet = {
			name = "NAME_Ether_Hatchling"
			settings = { 
				can_upgrade = no 
				can_change_composition = yes
				can_change_leader = yes
				uses_naval_capacity = no
				spawn_debris = no
			}				
			effect = {
				set_owner = root.owner
				create_ship_design = {
					design = NAME_Dragonspawn
				}
				create_ship = {
					design = last_created_design
					name = "NAME_Scile"
					prefix = no
					upgradable = no
				}
				set_location = root
			}
		}
		owner = { set_country_flag = hatched_dragon }
	}

	option = {
		name = leviathans.664.a
		custom_tooltip = leviathans.664.a.tooltip
	}
}