namespace = fatalf
# Spice Consumption Gatekeeper
country_event = {
	id = fatalf.4001
	hide_window = yes
	fire_only_once = yes
	trigger = {
		NOR = {
			is_ai = yes
			is_gestalt = yes
			end_game_years_passed > 0
			mid_game_years_passed < 0
		}
		any_country = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country
			has_established_contact = root
		}

	}
	mean_time_to_happen = { years = 100 }
	immediate = {
		random_country = {
			limit = {
				is_country_type = enclave
				has_country_flag = trader_enclave_country
				has_established_contact = root
			}
			save_event_target_as = spice_traders
		}
		country_event = { id = fatalf.400 days = 1 }
	}
}

#DEBUG
# country_event = {
# 	id = fatalf.4002
# 	hide_window = yes
# 	is_triggered_only = yes
# 	immediate = {
# 		random_country = {
# 			limit = { is_country_type = enclave has_country_flag = trader_enclave_country }
# 			save_event_target_as = spice_traders
# 		}
# 		country_event = { id = fatalf.400 days = 1 }
# 	}
# }

# 500 - Start
country_event = {
	id = fatalf.400
	title = fatalf.400.name
	desc = fatalf.400.desc
	is_triggered_only = yes
	diplomatic = yes
	picture_event_data = {
		portrait = event_target:spice_traders
		room = enclave_trader_room
	}
	option = {
		name = "fatalf.400.accept"
		allow = {
			has_country_resource = { type = energy amount >= 500 }
		}
		add_resource = { energy = -500 }
		add_modifier = { modifier = fatalf_spica years = 10 }
		custom_tooltip = fatalf.400.tip
		hidden_effect = {
			change_variable = { which = spice_cost value = 500 }
			country_event = { id = fatalf.4011 days = 3600 }
		}
	}
	option = { name = "fatalf.400.decline" }
}

# 1000
country_event = {
	id = fatalf.4011
	title = fatalf.4011.name
	desc = fatalf.4011.desc
	is_triggered_only = yes
	diplomatic = yes
	picture_event_data = {
		portrait = event_target:spice_traders
		room = enclave_trader_room
	}
	immediate = { remove_modifier = fatalf_spica }
	option = {
		name = "fatalf.411.accept"
		allow = {
			has_country_resource = { type = energy amount >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = { modifier = fatalf_spica years = 10 }
		custom_tooltip = fatalf.4011.tip
		hidden_effect = {
			country_event = { id = fatalf.4012 days = 3600 }
		}
	}
	option = {
		name = "fatalf.400.decline"
		add_modifier = { modifier = fatalf_spica_withdrawl years = 25 }
	}
}

# 2000
country_event = {
	id = fatalf.4012
	title = fatalf.4011.name
	desc = fatalf.4011.desc
	is_triggered_only = yes
	diplomatic = yes
	picture_event_data = {
		portrait = event_target:spice_traders
		room = enclave_trader_room
	}
	immediate = { remove_modifier = fatalf_spica }
	option = {
		name = "fatalf.411.accept"
		allow = {
			has_country_resource = { type = energy amount >= 2000 }
		}
		add_resource = { energy = -2000 }
		add_modifier = { modifier = fatalf_spica years = 10 }
		custom_tooltip = fatalf.4011.tip
		hidden_effect = {
			country_event = { id = fatalf.4013 days = 3600 }
		}
	}
	option = {
		name = "fatalf.400.decline"
		add_modifier = { modifier = fatalf_spica_withdrawl years = 25 }
	}
}

# 3500
country_event = {
	id = fatalf.4013
	title = fatalf.4011.name
	desc = fatalf.4011.desc
	is_triggered_only = yes
	diplomatic = yes
	picture_event_data = {
		portrait = event_target:spice_traders
		room = enclave_trader_room
	}
	immediate = { remove_modifier = fatalf_spica }
	option = {
		name = "fatalf.411.accept"
		allow = {
			has_country_resource = { type = energy amount >= 3500 }
		}
		add_resource = { energy = -3500 }
		add_modifier = { modifier = fatalf_spica years = 10 }
		custom_tooltip = fatalf.4011.tip
		hidden_effect = {
			country_event = { id = fatalf.4014 days = 3600 }
		}
	}
	option = {
		name = "fatalf.400.decline"
		add_modifier = { modifier = fatalf_spica_withdrawl years = 25 }
	}
}

# 6000
country_event = {
	id = fatalf.4014
	title = fatalf.4011.name
	desc = fatalf.4011.desc
	is_triggered_only = yes
	diplomatic = yes
	picture_event_data = {
		portrait = event_target:spice_traders
		room = enclave_trader_room
	}
	immediate = { remove_modifier = fatalf_spica }
	option = {
		name = "fatalf.411.accept"
		allow = {
			has_country_resource = { type = energy amount >= 6000 }
		}
		add_resource = { energy = -6000 }
		add_modifier = { modifier = fatalf_spica years = 10 }
		custom_tooltip = fatalf.4011.tip
		hidden_effect = {
			country_event = { id = fatalf.4015 days = 3600 }
		}
	}
	option = {
		name = "fatalf.400.decline"
		add_modifier = { modifier = fatalf_spica_withdrawl years = 25 }
	}
}

# 10000 - Max cost
country_event = {
	id = fatalf.4015
	title = fatalf.4011.name
	desc = fatalf.4011.desc
	is_triggered_only = yes
	diplomatic = yes
	picture_event_data = {
		portrait = event_target:spice_traders
		room = enclave_trader_room
	}
	immediate = { remove_modifier = fatalf_spica }
	option = {
		name = "fatalf.411.accept"
		allow = {
			has_country_resource = { type = energy amount >= 10000 }
		}
		add_resource = { energy = -10000 }
		add_modifier = { modifier = fatalf_spica years = 10 }
		custom_tooltip = fatalf.4011.tip
		hidden_effect = {
			country_event = { id = fatalf.4015 days = 3600 }
		}
	}
	option = {
		name = "fatalf.400.decline"
		add_modifier = { modifier = fatalf_spica_withdrawl years = 25 }
	}
}

# End Spice Consumption
