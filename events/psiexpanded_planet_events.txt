namespace = psiexpanded

#Complete destruction
planet_event = {
	id = psiexpanded.1
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		planet_devastation >= 100
		is_planet_class = pc_shrouded_paradise
	}
	
	immediate = {
		destroy_colony = yes
		random_list = {
			90 = { change_pc = pc_barren }
			5 = { change_pc = pc_shrouded }
			5 = { change_pc = pc_gaia }
		}
		reset_planet = yes
		if = {
			limit = { 
				NOR = {	
					is_planet_class = pc_shrouded 
					is_planet_class = pc_gaia 
				}
			}
			add_modifier = { modifier = "terraforming_candidate" days = -1 }
		}
	}
}

#Unlock Psiocracy
country_event = {
	id = psiexpanded.2
	title = psiexpanded.2.name
	desc = psiexpanded.2.desc
	picture = GFX_evt_hive_mind
	show_sound = event_celebration

	is_triggered_only = yes
	

	trigger = {
		has_technology = tech_expanded_psionic_theory
		NOR = {
			has_country_flag = psiocracy
			has_authority = auth_psiocratic
			has_authority = auth_corporate
			has_authority = auth_hive_mind
			has_ethic = ethic_gestalt_consciousness
			has_civic = civic_inwards_perfection
			has_civic = civic_post_apocalyptic
			has_civic = civic_mechanists
			has_civic = civic_syncretic_evolution
			has_civic = civic_fanatic_purifiers
			has_civic = civic_life_seeded
			has_civic = civic_barbaric_despoilers
		}
	}

	immediate = {
		set_country_flag = psiocracy
	}

	option = {
		name = psiexpanded.2.1
		custom_tooltip = psiexpanded.2.1.tooltip
		ai_chance = {
			factor = 5			
		}
		hidden_effect  = {
			change_government = {
				authority = auth_psiocratic
			}
			if = {
				limit = { has_ethic = "ethic_fanatic_militarist" }
				change_government = {
					civics = {
						civic = civic_psionic_descendants
						civic = civic_psionic_tranquility
						civic = civic_psionic_service
					}
				}
			}
			if = {
				limit = { has_ethic = "ethic_fanatic_pacifist" }
				change_government = {
					civics = {
						civic = civic_psionic_descendants
						civic = civic_psionic_tranquility
						civic = civic_psionic_protectionists
					}
				}
			}
			if = {
				limit = { has_ethic = "ethic_fanatic_spiritualist" }
				change_government = {
					civics = {
						civic = civic_psionic_descendants
						civic = civic_psionic_tranquility
						civic = civic_psionic_theocracy
					}
				}
			}
			if = {
				limit = { has_ethic = "ethic_fanatic_materialist" }
				change_government = {
					civics = {
						civic = civic_psionic_descendants
						civic = civic_psionic_tranquility
						civic = civic_psionic_technocracy
					}
				}
			}
			if = {
				limit = { has_ethic = "ethic_fanatic_xenophobe" }
				change_government = {
					civics = {
						civic = civic_psionic_descendants
						civic = civic_psionic_tranquility
						civic = civic_psionic_superiority
					}
				}
			}
			if = {
				limit = { has_ethic = "ethic_fanatic_xenophile" }
				change_government = {
					civics = {
						civic = civic_psionic_descendants
						civic = civic_psionic_tranquility
						civic = civic_psionic_empathizers
					}
				}
			}
			if = {
				limit = { has_ethic = "ethic_fanatic_egalitarian" }
				change_government = {
					civics = {
						civic = civic_psionic_descendants
						civic = civic_psionic_tranquility
						civic = civic_psionic_harmony
					}
				}
			}
			if = {
				limit = { has_ethic = "ethic_fanatic_authoritarian" }
				change_government = {
					civics = {
						civic = civic_psionic_descendants
						civic = civic_psionic_tranquility
						civic = civic_psionic_subsumed_telepathy
					}
				}
			}
			if = {
				limit = {
					NOR = {
						has_ethic = "ethic_fanatic_militarist"
						has_ethic = "ethic_fanatic_pacifist"
						has_ethic = "ethic_fanatic_spiritualist"
						has_ethic = "ethic_fanatic_materialist"
						has_ethic = "ethic_fanatic_xenophobe"
						has_ethic = "ethic_fanatic_xenophile"
						has_ethic = "ethic_fanatic_egalitarian"
						has_ethic = "ethic_fanatic_authoritarian"
					}
				}
				change_government = {
					civics = {
						civic = civic_psionic_descendants
						civic = civic_psionic_tranquility
						civic = civic_psionic_equilibrium
					}
				}
			}
		}
	}

	option = {
		name = psiexpanded.2.2
		custom_tooltip = psiexpanded.2.2.tooltip	
		ai_chance = {
			factor = 5			
		}	
	}
}	

#Civic Authority Start
country_event = {
	id = psiexpanded.4
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_civic = civic_shrouded_origins
		NOT = {
			has_country_flag = psishrouded
		}
	}
	
	immediate = {
		change_government = {
			authority = auth_psiocratic
		}
		give_technology = {
			tech = tech_psionic_theory		
		}
		set_country_flag = psishrouded
	}
}