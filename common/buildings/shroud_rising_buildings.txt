###########
# Army buildings
###########


building_planetary_bastion = {
	base_buildtime = 1000
	base_cap_amount = 1
	planetary_ftl_inhibitor = yes	
	can_be_ruined = no
	position_priority = 120
	can_demolish = yes

	category = army

	allow = {
		buildings_simple_allow = yes		
		has_building = building_fortress
	}
	
	

	prerequisites = {
			tech_starbase_4
		}
		
	upgrades = {
		"building_empire_bastion"
		}
	
	
	triggered_desc = {
		text = building_planetary_bastion_effect_desc
	}
		
	planet_modifier = {
		planet_orbital_bombardment_damage = -0.50
		planet_stability_add = 10
		planet_crime_add = -10
		pop_defense_armies_add = 1
	}
	
	
		
	army_modifier = {
		army_starting_experience_add = 100
	}
	resources = {
		category = planet_buildings_strongholds
		produces = {			
			unity = 5			
		}
		cost = {
			minerals = @b2_minerals
			alloys = 500
		}
		upkeep = {
			energy = 10
			alloys = 10
		}
	}


	ai_weight = {
		weight = 1.0		
		modifier = {
			factor = 2.0
			owner = {
				OR = {
					has_ethic = "ethic_fanatic_militarist"
					has_ethic = "ethic_militarist"
				}
			}
		}
		
		modifier = {
			factor = 3.0
			has_global_flag = eye_of_terror_open
		}
		
		
		modifier = {
			factor = 2.0
			solar_system = { 
				OR = {					
					is_bottleneck_system = yes 
					any_bordering_country = {
						is_unfriendly_to = root.owner
					}
				}
			}
		}
				
		
		modifier = {
			factor = 0 
			owner = {
				any_owned_planet = {
					NOR = {
						has_building_construction = building_fortress
						has_building_construction = building_stronghold 						
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			num_pops >= 70
		}
		modifier = {
			factor = 1.0
			num_pops >= 60
			num_pops < 70
		}
		modifier = {
			factor = 0.5
			num_pops >= 45
			num_pops < 60
		}
		modifier = {
			factor = 0.25
			num_pops >= 30
			num_pops < 45
		}
		modifier = {
			factor = 0
			num_pops < 30
		}
		
	}
	
}

building_empire_bastion = {
	base_buildtime = 1000	
	can_build = no	
	can_be_ruined = no
	can_demolish = yes
	planetary_ftl_inhibitor = yes
	position_priority = 120


	category = army

	# empire_limit = { 	
	 	# base = 1		
	 # }
		
	
	potential = {
		#exists = owner
	
	}

	allow = {
		has_upgraded_capital = yes
	}
	
	prerequisites = {
			tech_starbase_5
		}

	
	
	triggered_desc = {
		text = building_planetary_bastion_effect_desc
	}
	
	
	planet_modifier = {
		planet_orbital_bombardment_damage = -0.60
		planet_crime_add = -10
		planet_stability_add = 20
		pop_defense_armies_add = 1
	}
	
			
		
	army_modifier = {
		army_starting_experience_add = 200
	}
	resources = {
		category = planet_buildings_strongholds
		produces = {			
			unity = 5			
		}
		cost = {
			minerals = @b2_minerals
			alloys = 750
		}
		upkeep = {
			energy = 15
			alloys = 20
		}
	}

	
	
	ai_weight = {
		weight = 1.0		
		modifier = {
			factor = 2.0
			owner = {
				OR = {
					has_ethic = "ethic_fanatic_militarist"
					has_ethic = "ethic_militarist"
				}
			}
		}
		
		modifier = {
			factor = 3.0
			has_global_flag = eye_of_terror_open
		}
		
		
		modifier = {
			factor = 2.0
			solar_system = { 
				OR = {					
					is_bottleneck_system = yes 
					any_bordering_country = {
						is_unfriendly_to = root.owner
					}
				}
			}
		}
				
		
		modifier = {
			factor = 0 
			owner = {
				any_owned_planet = {
					NOR = {
						has_building_construction = building_fortress
						has_building_construction = building_stronghold 						
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			num_pops >= 70
		}
		modifier = {
			factor = 1.0
			num_pops >= 60
			num_pops < 70
		}
		modifier = {
			factor = 0.5
			num_pops >= 45
			num_pops < 60
		}
		modifier = {
			factor = 0.25
			num_pops >= 30
			num_pops < 45
		}
		modifier = {
			factor = 0
			num_pops < 30
		}
		
	}
	
}

building_monolith_mysterious = {
	base_buildtime = @b2_time
	base_cap_amount = 1	
	can_build = no
	planetary_ftl_inhibitor = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 25
	
	
	potential = {}

	country_modifier = {
		category_psionics_research_speed_mult = 0.15
	}
	
	planet_modifier = {
		planet_stability_add = -10
		planet_jobs_engineering_research_produces_mult = 0.15
		planet_max_buildings_add = 1
		planet_jobs_energy_produces_mult = -0.30
	}
	resources = {
		category = planet_buildings_strongholds
		produces = {			
			
		}
		cost = {
					
		}
		upkeep = {
				
		}
	}
}

building_monolith = {
	base_buildtime = @b2_time
	base_cap_amount = 1
	can_be_ruined = no
	can_build = yes
	planetary_ftl_inhibitor = no
	position_priority = 100
	can_demolish = yes
	can_be_ruined = no
	can_be_disabled = no
	icon = building_monolith_mysterious
		
	allow = {
			
			
		}
		
	destroy_trigger = {
		exists = owner		
		AND = { 
			owner = { is_ai = yes }
			owner = { has_civic = civic_shroud_cult }
		}
	}
	triggered_desc = {
		text = building_monolith_effect_desc
	}

	country_modifier = {
		category_psionics_research_speed_mult = 0.15
	}
	
	planet_modifier = {
		planet_stability_add = 15	
		pop_ethic_spiritualist_attraction_mult = 0.15
		planet_max_buildings_add = 1
		planet_jobs_energy_produces_mult = -0.30
	}
	resources = {
		category = planet_buildings_strongholds
		produces = {			
			unity = 3
		}
		cost = {
			sr_zro = 100
			alloys = 250
			minerals = @b2_minerals			
		}
		upkeep = {				
		}
	}

	prerequisites = {
		tech_shroud_monolith
	}
	
	on_built = {
		set_planet_flag = has_shroud_monolith  #an action when built
		remove_modifier = monolith_planet		
		if = { 
			limit = {
				is_planet_class = pc_shroud_touched
			}
			#change_pc = pc_gaia
			remove_modifier = shroud_composer_effect
			remove_modifier = shroud_eater_effect
			remove_modifier = shroud_desire_effect 
			remove_modifier = shroud_whisperer_effect
			add_modifier = { modifier = shroud_touched_stabilized days = -1 }
		}
		
	}
	
	on_destroy = {
		remove_planet_flag = has_shroud_monolith  #an action when destroyed
		remove_modifier = shroud_touched_stabilized
	}
	
	ai_weight = {
		weight = 1.0		
		modifier = {
			factor = 2.0
			owner = {
				OR = {
					has_ethic = "ethic_fanatic_militarist"
					has_ethic = "ethic_militarist"
				}
			}
		}
		
		modifier = {
			factor = 3.0
			has_global_flag = eye_of_terror_open
		}
		
		
		modifier = {
			factor = 2.0
			
		}
				
		
		modifier = {
			factor = 5 
			owner = {
				any_owned_planet = {
					OR = {
						has_planet_flag = eye_of_terror_shrouded_world
						has_building_construction = building_stronghold 						
					}
				}
				has_country_flag = had_world_invaded_by_cult
				has_country_flag = world_devoured
			}
		}
		modifier = {
			factor = 1.5
			num_pops >= 70
		}
		modifier = {
			factor = 1.0
			num_pops >= 60
			num_pops < 70
		}
		modifier = {
			factor = 0.5
			num_pops >= 45
			num_pops < 60
		}
		modifier = {
			factor = 0.25
			num_pops >= 30
			num_pops < 45
		}
		modifier = {
			factor = 0
			num_pops < 30
		}
		modifier = {
			factor = 0
			owner = {			
				has_civic = civic_shroud_cult
				}
		}
	}
}