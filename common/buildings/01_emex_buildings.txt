# Born of Knowledge - Capital Buildings
#Stage 1 - Core Processor Complex
building_bok_capital_1 = {
	base_buildtime = @b2_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	building_sets = {
		government
	}

	potential = {
		exists = owner
		owner = {
			AND = {
				has_origin = origin_born_of_knowledge
				is_machine_empire = yes
			}
		}
		is_capital = yes
	}

	destroy_trigger = {
		exists = owner
		owner = {
			NOT = { has_origin = origin_born_of_knowledge }
		}
	}

	convert_to = {
		building_hive_capital
		building_deployment_post
		building_resort_capital
		building_slave_capital
		building_ancient_control_center
		building_ancient_palace
		building_colony_shelter_wilderness
		building_colony_shelter
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	prerequisites = {
		"tech_planetary_government"
	}

	planet_modifier = {
		planet_housing_add = 300
		planet_amenities_add = 500
		job_replicator_add = 100
		job_patrol_drone_add = 100
		job_maintenance_drone_add = 200
		planet_max_buildings_add = 1
		#Addition bonuses:
		job_core_custodian_add = 200
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_machine_assimilator }
		}
		modifier = {
			job_replicator_add = -100
			job_maintenance_drone_add = 100
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = @b2_upkeep
		}
	}

	upgrades = {
		building_bok_capital_2
	}

	triggered_desc = {
		text = job_core_custodian_effect_desc
	}

	triggered_desc = {
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		text = job_patrol_drone_effect_desc
	}

	triggered_desc = {
		text = job_maintenance_drone_effect_desc
	}
}

#Stage 2 - Repurposed Grand Mainframe
building_bok_capital_2 = {
	base_buildtime = @b3_time
	capital = yes
	can_build = yes #no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	building_sets = {
		government
	}

	potential = {
		exists = owner
		owner = {
			AND = {
				has_origin = origin_born_of_knowledge
				is_machine_empire = yes
			}
		}
		is_capital = yes
	}

	destroy_trigger = {
		exists = owner
		owner = {
			NOT = { has_origin = origin_born_of_knowledge }
		}
	}

	convert_to = {
		building_hive_capital
		building_machine_capital
		building_resort_capital
		building_slave_capital
		building_ancient_control_center
		building_ancient_palace
		building_capital_wilderness
		building_capital
	}

	allow = {
		sapient_pop_amount >= 2000
	}

	prerequisites = {
		"tech_colonial_centralization"
	}

	show_tech_unlock_if = {
		has_origin = origin_born_of_knowledge
	}

	planet_modifier = {
		planet_housing_add = 800
		planet_amenities_add = 1000
		job_replicator_add = 200
		job_patrol_drone_add = 200
		job_maintenance_drone_add = 200
		planet_max_buildings_add = 2
		#Addition bonuses:
		job_core_custodian_add = 300
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_machine_assimilator }
		}
		modifier = {
			job_replicator_add = -100
			job_maintenance_drone_add = 100
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = @b3_upkeep
		}
	}

	upgrades = {
		building_bok_capital_3
	}

	triggered_desc = {
		text = job_core_custodian_effect_desc
	}

	triggered_desc = {
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		text = job_patrol_drone_effect_desc
	}

	triggered_desc = {
		text = job_maintenance_drone_effect_desc
	}
}

#Stage 3 - Crux of Infinity
building_bok_capital_3 = {
	base_buildtime = @b4_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	building_sets = {
		government
	}

	potential = {
		exists = owner
		owner = {
			AND = {
				has_origin = origin_born_of_knowledge
				is_machine_empire = yes
			}
		}
		is_capital = yes
	}

	destroy_trigger = {
		exists = owner
		owner = {
			NOT = { has_origin = origin_born_of_knowledge }
		}
	}

	convert_to = {
		building_hive_major_capital
		building_machine_major_capital
		building_resort_major_capital
		building_slave_major_capital
		building_ancient_control_center
		building_ancient_palace
		building_major_capital_wilderness
		building_major_capital
	}

	allow = {
		sapient_pop_amount >= 4000
	}

	prerequisites = {
		"tech_galactic_administration"
	}

	show_tech_unlock_if = {
		has_origin = origin_born_of_knowledge
	}

	planet_modifier = {
		planet_housing_add = 1000
		planet_amenities_add = 1500
		job_replicator_add = 200
		job_patrol_drone_add = 200
		job_maintenance_drone_add = 300
		planet_max_buildings_add = 3
		#Addition bonuses:
		job_core_custodian_add = 400
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_machine_assimilator }
		}
		modifier = {
			job_replicator_add = -100
			job_maintenance_drone_add = 100
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = @b3_upkeep
		}
	}

	triggered_desc = {
		text = job_core_custodian_effect_desc
	}

	triggered_desc = {
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		text = job_patrol_drone_effect_desc
	}

	triggered_desc = {
		text = job_maintenance_drone_effect_desc
	}
}

# Biomatter Research Plant
building_biomatter_research = {
	base_buildtime = @b1_time
	category = resource
	planet_limit = 2

	destroy_trigger = {
		OR = {
			has_modifier = resort_colony
			is_planet_class = pc_emex_processing_core
		}
	}

	building_sets = {
		research
	}

	potential = {
		NOT = { has_modifier = resort_colony }
		is_planet_class = pc_emex_bio_mechanical
	}

	planet_modifier = {
		job_engineer_add = 75
		job_physicist_add = 75
		job_biologist_add = 75
		planet_researchers_upkeep_mult = -0.15
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = 300
		}
		upkeep = {
			food = 10
		}
	}

	ai_weight = {
		weight = 2
	}
}

# Overlord Gene Labs (holding)
holding_overlord_gene_labs = {
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_disease_control
	planet_limit = 1

	category = research

	potential = {
		owner.overlord = {
			has_valid_civic = civic_hive_manipulators_of_life
		}
	}

	resources = {
		category = planet_holdings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	planet_modifier = {
		monthly_loyalty = -1.5
		logistic_growth_mult = -0.10
		bonus_pop_growth_mult = -0.1
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = no }
		}
		job_overlord_academic_add = 200
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = yes }
		}
		job_overlord_academic_drone_add = 200
	}

	triggered_desc = {
		text = job_verlord_academic_effect_desc
	}
	
}

# (Senate Dependency) Ambassadorial Offices (holding)
building_ambassadorial_offices = {
	base_buildtime = @b1_time
	owner_type = subject_holding
	planet_limit = 1

	category = unity

	potential = {
	}
	
	allow = {
		custom_tooltip = {
			fail_text = subject_is_comvas
			exists = planet.owner
			planet.owner = {
				is_specialist_subject_type = { TYPE = community_vassal }
			}
		}
	}

	resources = {
		category = planet_holdings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	planet_modifier = {
		monthly_loyalty = -1
		job_overlord_diplomat_add = 200
	}
	
	triggered_country_modifier = {
		diplo_weight_pops_mult = 0.10
	}

}

# Minor Nanite Factory
building_nanite_forge_1 = {
	base_buildtime = @b1_time
	category = resource

	building_sets = {
		urban
	}

	destroy_trigger = {
		owner = { NOT = { has_valid_civic = civic_machine_selfreplicating_machines } }
	}

	potential = {
		NOT = { has_modifier = resort_colony }
		owner = { has_valid_civic = civic_machine_selfreplicating_machines }
	}

	planet_modifier = {
		job_nanite_synthesiser_add = 100
		planet_pop_assemblers_produces_mult = 0.05
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = @b2_upkeep
		}
	}

	upgrades = {
		"building_nanite_forge_2"
	}

	triggered_desc = {
		text = job_nanite_synthesiser_effect_desc
	}

	ai_weight = {
		weight = 10
	}
}

# Central Nanite Factory
building_nanite_forge_2 = {
	base_buildtime = @b1_time
	category = resource
	can_build = no

	building_sets = {
		urban
	}

	destroy_trigger = {
		owner = { NOT = { has_valid_civic = civic_machine_selfreplicating_machines } }
	}

	potential = {
		is_capital = yes
		owner = { has_valid_civic = civic_machine_selfreplicating_machines }
	}

	planet_modifier = {
		job_nanite_synthesiser_add = 200
		planet_pop_assemblers_produces_mult = 0.05
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = @b2_upkeep
		}
	}

	triggered_desc = {
		text = job_nanite_synthesiser_effect_desc
	}

	ai_weight = {
		weight = 10
	}
}

# (Corporate) Peacekeeping Outpost
building_corporate_peacekeeping_outpost = {
	base_buildtime = @b1_time
	owner_type = corporate
	planet_limit = 1

	category = research

	potential = {
		has_branch_office = yes
		branch_office_owner = { has_valid_civic = civic_corporate_mediators }
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	planet_modifier = {
		job_soldier_add = 200
		branch_office_value_mult = 0.05
	}
	
	country_modifier = {
		country_naval_cap_mult = 0.10
		federation_naval_cap_contribution_mult = 0.10
	}
}