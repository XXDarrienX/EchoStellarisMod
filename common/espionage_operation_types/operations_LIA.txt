@diff_ta = -1 # 가장 낮은 난이도
@diff_tm = 0 # 공격적 암호적용 전용

@diff_t0 = 4
@diff_t1 = 5
@diff_t2 = 6
@diff_t3 = 7
@diff_t4 = 8
@diff_t5 = 9
@diff_t6 = 10
@diff_t7 = 11
@diff_t8 = 12
@diff_t9 = 13

@diff_tt = -5 # 모딩 테스트 전용

@operationTargetedByTimer = 10800 #30 years during which the effects of an operation may be felt by select Spy Network events

## 심층 기술 탈취-물리학
op_steal_tech_physics = {
    target = none
    categories = { op_cat_subterfuge op_cat_technology }
    picture = GFX_evt_physics_research
    desc = op_steal_tech_physics_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			influence = 50
            energy = 1200
        }
        upkeep = {
            energy = 8
        }
    }

    spy_power_cost = 50
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = no			
        }
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_steal_technology_enigmatic_engineering
            owner = {
                NOT = { has_country_flag = cannot_steal_enigmatic_tech@root.target } #set after failing this operation before, due to Enigmatic Engineering
            }
        }
		custom_tooltip = {
			fail_text = operation_steal_technology_too_recent
			NOT = { has_spynetwork_flag = recently_stole_technology }
		}		
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = {
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1020
    }
    stage = {
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1021
    }	
    stage = {
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_target
        event = operation.20000
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = {
            RANDOM_EVENTS = operation_random_events_generic
        }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 심층 기술 탈취-사회학
op_steal_tech_society = {
    target = none
    categories = { op_cat_subterfuge op_cat_technology }
    picture = GFX_evt_physics_research
    desc = op_steal_tech_society_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			influence = 50
            energy = 1200
        }
        upkeep = {
            energy = 8
        }
    }

    spy_power_cost = 50
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = no			
        }	
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_steal_technology_enigmatic_engineering
            owner = {
                NOT = { has_country_flag = cannot_steal_enigmatic_tech@root.target } #set after failing this operation before, due to Enigmatic Engineering
            }
        }
		custom_tooltip = {
			fail_text = operation_steal_technology_too_recent
			NOT = { has_spynetwork_flag = recently_stole_technology }
		}
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = {
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1020
    }
    stage = {
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1021
    }	
    stage = {
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_target
        event = operation.20003
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = {
            RANDOM_EVENTS = operation_random_events_generic
        }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 심층 기술 탈취-공학
op_steal_tech_engineering = {
    target = none
    categories = { op_cat_subterfuge op_cat_technology }
    picture = GFX_evt_physics_research
    desc = op_steal_tech_engineering_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			influence = 50
            energy = 1200
        }
        upkeep = {
            energy = 8
        }
    }

    spy_power_cost = 50
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = no			
        }	
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_steal_technology_enigmatic_engineering
            owner = {
                NOT = { has_country_flag = cannot_steal_enigmatic_tech@root.target } #set after failing this operation before, due to Enigmatic Engineering
            }
        }
		custom_tooltip = {
			fail_text = operation_steal_technology_too_recent
			NOT = { has_spynetwork_flag = recently_stole_technology }
		}
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = {
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1020
    }
    stage = {
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1021
    }	
    stage = {
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_target
        event = operation.20006
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = {
            RANDOM_EVENTS = operation_random_events_generic
        }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 무역협정 로비
op_trade_agreement = {
    target = none
    categories = { op_cat_manipulation op_cat_diplomacy }
    picture = GFX_evt_acquire_asset
    desc = op_trade_agreement_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 200
			consumer_goods = 100
        }
        upkeep = {
            energy = 5
			consumer_goods = 5
        }
    }

    spy_power_cost = 25
    potential = { 
		has_nemesis = yes 
        owner = { is_gestalt = no }
        target = { is_gestalt = no }
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_trade_agreement_too_recent
            owner = {
                NOT = { has_country_flag = recently_trade_agreement@root.target }
            }
        }
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
        custom_tooltip = { ##토탈워 제국이면 이거 못걸게
            fail_text = target_is_purge_empire
            owner = {
                NOT = { ##근데 원래도 군체와 기계한텐 못쓰게 만들었으니까 그냥 정화자 시빅 하나만 더 조건에 추가하면 되겠네?
					has_valid_civic = civic_fanatic_purifiers		
				}
            }			
        }		
    }
    stage = { #Install operatives
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20010
    }
    stage = { #Target identified
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_target
        event = operation.20011
    }	
    stage = { #Result
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20012
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 금융위기 조장
op_financial_crisis = {
    target = none
    categories = { op_cat_provocation op_cat_economy }
    picture = GFX_evt_acquire_asset
    desc = op_financial_crisis_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 2000
        }
        upkeep = {
            energy = 10
			physics_research = 5
			engineering_research = 5
			society_research = 5
        }
    }

    spy_power_cost = 50
    potential = { 
		has_nemesis = yes 
        target = { is_gestalt = no }	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_financial_crisis_too_danger
            owner = {
                NOT = { has_modifier = lia_op_finance_c }
            }
        }
        custom_tooltip = {
            fail_text = operation_financial_crisis_too_danger2
            owner = {
                NOT = { has_modifier = lia_op_finance_e }
            }
        }		
        custom_tooltip = {
            fail_text = operation_financial_crisis_too_recent
            owner = {
                NOT = { has_country_flag = recently_financial_crisis@root.target }
            }
        }
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20020
    }
    stage = { #Target identified
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20021
    }
    stage = { #Result
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20022
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 자원생산 사보타주
op_resource_sabotage = {
    target = none
    categories = { op_cat_sabotage op_cat_economy }
    picture = GFX_evt_acquire_asset
    desc = op_resource_sabotage_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 800
			influence = 10
        }
        upkeep = {
            energy = 8
        }
    }

    spy_power_cost = 30
	
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = no			
        }	
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_sabotage_resource_no_targets
            target = {
                any_owned_planet = {
                    OR = {
						num_districts = { type = district_generator value > 1 }
						num_districts = { type = district_mining value > 1 }
						num_districts = { type = district_farming value > 1 }		
						num_districts = { type = district_rw_generator value > 0 }
						num_districts = { type = district_rw_farming value > 0 }
						num_districts = { type = district_hab_energy value > 1 }
						num_districts = { type = district_hab_mining value > 1 }
                    }
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20030
    }
    stage = { #Target identified
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_target
        event = operation.20031
    }	
    stage = { #Result
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20032
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 전략물자 비축분 테러
op_strategic_materials = {
    target = none
    categories = { op_cat_sabotage op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_strategic_materials_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 2000
			influence = 20
        }
        upkeep = {
            energy = 8
        }
    }

    spy_power_cost = 40 ##원래 첩보망 조건은 40
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_strategic_materials_no_targets
            target = {
                OR = {
					resource_stockpile_compare = {
						resource = alloys
						value > 500
					}
					resource_stockpile_compare = {
						resource = volatile_motes
						value > 200
					}
					resource_stockpile_compare = {
						resource = exotic_gases
						value > 200
					}
					resource_stockpile_compare = {
						resource = rare_crystals
						value > 200
					}					
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t4 ## 원래 난이도는 t4였다
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20040
    }
    stage = { #Target identified
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20041
    }	
    stage = { #Result
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20042
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 가짜뉴스 살포
op_fake_news = {
    target = none
    categories = { op_cat_manipulation op_cat_government }
    picture = GFX_evt_acquire_asset
    desc = op_fake_news_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 500
			unity = 500
        }
        upkeep = {
            energy = 5
			society_research = 10
			unity = 10
        }
    }

    spy_power_cost = 30
    potential = { 
		has_nemesis = yes 
        target = { is_gestalt = no }
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_fake_news_too_recent
            owner = {
                NOT = { has_country_flag = recently_fake_news@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20050
    }
    stage = { #Target identified
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_target
        event = operation.20051
    }	
    stage = { #Result
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20052
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 반정부 시위 후원
op_support_antigov = {
    target = none
    categories = { op_cat_subterfuge op_cat_government }
    picture = GFX_evt_acquire_asset
    desc = op_support_antigov_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 1600
			influence = 20
        }
        upkeep = {
            energy = 5
			influence = 1
        }
    }

    spy_power_cost = 40
    potential = { 
		has_nemesis = yes 
        target = { is_gestalt = no }	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_support_antigov_too_recent
            owner = {
                NOT = { has_country_flag = recently_support_antigov@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20060
    }
    stage = { #Target identified
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20061
    }	
    stage = { #Result
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20062
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 전쟁범죄 공론화
op_war_crime = {
    target = none
    categories = { op_cat_manipulation op_cat_diplomacy }
    picture = GFX_evt_acquire_asset
    desc = op_war_crime_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 500		
            influence = 50
        }
        upkeep = {
            influence = 1.5
        }
    }

    spy_power_cost = 25
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_war_crime_in_war
            target = {
				off_war_exhaustion_sum > 0
            }
        }
        custom_tooltip = {
            fail_text = operation_war_crime_too_recent
            owner = {
                NOT = { has_country_flag = recently_war_crime@root.target }
            }
        }		
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20070
    }
    stage = { #Target identified
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_target
        event = operation.20071
    }	
    stage = { #Result
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20072
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 암시장 무기 지원
op_vietnam_var = {
    target = none
    categories = { op_cat_manipulation op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_vietnam_var_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			alloys = 500
			energy = 1000
			influence = 50
        }
        upkeep = {
            influence = 1
			alloys = 10
        }
    }

    spy_power_cost = 10
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_vietnam_war_in_war
            target = {
				def_war_exhaustion_sum > 0
            }
        }
        custom_tooltip = {
            fail_text = operation_vietnam_war_too_recent
            owner = {
                NOT = { has_country_flag = recently_vietnam_war@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t0
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20080
    }
    stage = { #Target identified
        difficulty = @diff_t0
        icon = GFX_espionage_chapter_icon_target
        event = operation.20081
    }	
    stage = { #Result
        difficulty = @diff_t0
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20082
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 외교관계 향상
op_diplo_plus = {
    target = none
    categories = { op_cat_manipulation op_cat_diplomacy }
    picture = GFX_evt_acquire_asset
    desc = op_diplo_plus_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 800
			influence = 50
        }
        upkeep = {
            influence = 1
        }
    }

    spy_power_cost = 15
    potential = { 
		has_nemesis = yes 
        #target = { is_hive_empire = yes }
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_diplo_plus_too_recent
            owner = {
                NOT = { has_country_flag = recently_diplo_plus@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20400
    }
    stage = { #Target identified
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_target
        event = operation.20401
    }	
    stage = { #Result
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20402
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 자원 탈취
op_mineral_plunder = {
    target = none
    categories = { op_cat_sabotage op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_mineral_plunder_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 800
			alloys = 200
        }
        upkeep = {
            energy = 5
			alloys = 5
        }
    }

    spy_power_cost = 40
    potential = { 
		has_nemesis = yes 
        #target = { is_hive_empire = yes }
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_mineral_plunder_no_targets
            target = {
                OR = {
					resource_stockpile_compare = {
						resource = food
						value > 2000
					}
					resource_stockpile_compare = {
						resource = minerals
						value > 2000
					}				
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20410
    }
    stage = { #Target identified
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20411
    }	
    stage = { #Result
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20412
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 크레딧 빼돌리기
op_credit_plunder = {
    target = none
    categories = { op_cat_sabotage op_cat_economy }
    picture = GFX_evt_acquire_asset
    desc = op_credit_plunder_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			consumer_goods = 400
        }
        upkeep = {
            physics_research = 30
        }
    }

    spy_power_cost = 40
    potential = { 
		has_nemesis = yes 
        #target = { is_hive_empire = yes }
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_credit_plunder_no_targets
            target = {
				resource_stockpile_compare = {
					resource = energy
					value > 2000
				}				
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20420
    }
    stage = { #Target identified
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20421
    }	
    stage = { #Result
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20422
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 군체의식 신경망 교란
op_disturb_hive = {
    target = none
    categories = { op_cat_provocation op_cat_technology }
    picture = GFX_evt_acquire_asset
    desc = op_disturb_hive_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			food = 2000
        }
        upkeep = {
            food = 10
			society_research = 20
        }
    }

    spy_power_cost = 50
    potential = { 
		has_nemesis = yes 
        target = { is_hive_empire = yes }
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_disturb_hive_too_recent
            owner = {
                NOT = { has_country_flag = recently_disturb_hive@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t6
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20090
    }
    stage = { #Target identified
        difficulty = @diff_t6
        icon = GFX_espionage_chapter_icon_target
        event = operation.20091
    }	
    stage = { #Result
        difficulty = @diff_t6
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20092
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 기계지능 연산망 교란
op_disturb_mach = {
    target = none
    categories = { op_cat_provocation op_cat_technology }
    picture = GFX_evt_acquire_asset
    desc = op_disturb_mach_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 2000
        }
        upkeep = {
			energy = 10
			physics_research = 10
			engineering_research = 10
        }
    }

    spy_power_cost = 50
    potential = { 
		has_nemesis = yes 
        target = { is_machine_empire = yes }	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_disturb_mach_too_recent
            owner = {
                NOT = { has_country_flag = recently_disturb_mach@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t6
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20100
    }
    stage = { #Target identified
        difficulty = @diff_t6
        icon = GFX_espionage_chapter_icon_target
        event = operation.20101
    }	
    stage = { #Result
        difficulty = @diff_t6
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20102
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 자율형 고위 드론 포섭   (나중에 넣을꺼야)
#op_high_drone = {
#    target = none
#    categories = { op_cat_manipulation op_cat_diplomacy }
#    picture = GFX_evt_acquire_asset
#    desc = op_high_drone_desc
#    stages = 3
#
#    resources = {
#        category = operations
#        cost = {
#			alloys = 500
#			energy = 1000
#			influence = 50
#        }
#        upkeep = {
#            influence = 2
#			alloys = 10
#        }
#    }
#
#    spy_power_cost = 5
#    spy_network_lvl_requirement = 5
#    potential = { 
#		has_nemesis = yes 
#        #target = { is_gestalt = yes }	
#	}
#    allow = {
#        custom_tooltip = {
#            is_running_espionage_operation = no
#            fail_text = operation_one_at_a_time
#        }
#    }
#    stage = { #Install operatives
#        difficulty = @diff_t1
#        icon = GFX_espionage_chapter_icon_surveillance
#        event = operation.20110
#    }
#    stage = { #Target identified
#        difficulty = @diff_t1
#        icon = GFX_espionage_chapter_icon_target
#        event = operation.20111
#    }	
#    stage = { #Result
#        difficulty = @diff_t1
#        icon = GFX_espionage_chapter_icon_motion
#        event = operation.20112
#    }
#    on_roll_failed = {
#        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
#    }
#    on_create = {
#        target = {
#            set_timed_country_flag = {
#                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
#                days = @operationTargetedByTimer
#            }
#        }
#    }
#}
## 악령 신호   (나중에 넣을꺼야)
#op_spectre_sign = {
#    target = none
#    categories = { op_cat_sabotage op_cat_technology }
#    picture = GFX_evt_acquire_asset
#    desc = op_spectre_sign_desc
#    stages = 3
#
#    resources = {
#        category = operations
#        cost = {
#			alloys = 500
#			energy = 1000
#			influence = 50
#        }
#        upkeep = {
#            influence = 2
#			alloys = 10
#        }
#    }
#
#    spy_power_cost = 5
#    spy_network_lvl_requirement = 5
#    potential = { 
#		has_nemesis = yes 
#        #target = { is_machine_empire = yes }	
#	}
#    allow = {
#        custom_tooltip = {
#            is_running_espionage_operation = no
#            fail_text = operation_one_at_a_time
#        }
#    }
#    stage = { #Install operatives
#        difficulty = @diff_t1
#        icon = GFX_espionage_chapter_icon_surveillance
#        event = operation.20120
#    }
#    stage = { #Target identified
#        difficulty = @diff_t1
#        icon = GFX_espionage_chapter_icon_target
#        event = operation.20121
#    }	
#    stage = { #Result
#        difficulty = @diff_t1
#        icon = GFX_espionage_chapter_icon_motion
#        event = operation.20122
#    }
#    on_roll_failed = {
#        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
#    }
#    on_create = {
#        target = {
#            set_timed_country_flag = {
#                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
#                days = @operationTargetedByTimer
#            }
#        }
#    }
#}
## 훈련중 함선사고 유발
op_ship_accident = {
    target = none
    categories = { op_cat_sabotage op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_ship_accident_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 400
			consumer_goods = 200
        }
        upkeep = {
            engineering_research = 10
        }
    }

    spy_power_cost = 40	#원래 45
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_ship_accident_no_targets
            target = {
                any_owned_ship = {
                    OR = {
						is_ship_size = corvette
						is_ship_size = destroyer
						is_ship_size = cruiser
						is_ship_size = battleship
						is_ship_size = titan						
                    }
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t5	#원래 전부 t5등급
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20130
    }
    stage = { #Target identified
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_target
        event = operation.20131
    }	
    stage = { #Result
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20132
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 훈련중 대규모 함대사고 유발
op_fleet_accident = {
    target = none
    categories = { op_cat_sabotage op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_fleet_accident_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 500
			consumer_goods = 500
        }
        upkeep = {
            influence = 0.5
        }
    }

    spy_power_cost = 55
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_fleet_accident_too_recent
            owner = {
                NOT = { has_country_flag = recently_fleet_accident@root.target }
            }
        }	
        custom_tooltip = {
            fail_text = operation_fleet_accident_no_targets
            target = {
                any_owned_ship = {
                    OR = {
						is_ship_size = corvette
						is_ship_size = destroyer
						is_ship_size = cruiser
						is_ship_size = battleship
						is_ship_size = titan						
                    }
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t6
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20430
    }
    stage = { #Target identified
        difficulty = @diff_t6
        icon = GFX_espionage_chapter_icon_target
        event = operation.20431
    }	
    stage = { #Result
        difficulty = @diff_t6
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20432
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 하이퍼레인 항법시스템 방해
op_hyperlane_dist = {
    target = none
    categories = { op_cat_subterfuge op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_hyperlane_dist_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 2000
        }
        upkeep = {
			physics_research = 10
			energy = 10
        }
    }

    spy_power_cost = 35
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_hyperlane_dist_too_recent
            owner = {
                NOT = { has_country_flag = recently_hyperlane_dist@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20140
    }
    stage = { #Target identified
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_target
        event = operation.20141
    }	
    stage = { #Result
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20142
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 적대적 첩보망 조사
op_spy_check = {
    target = none
    categories = { op_cat_subterfuge op_cat_diplomacy }
    picture = GFX_evt_spymaster
    desc = op_spy_check_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 1000
			influence = 25
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_spy_check_too_recent
            owner = {
                NOT = { has_country_flag = recently_spy_check@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20440
    }
    stage = { #승인
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_target
        event = operation.20441
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 선제적 역정보 배치
op_counter_check = {
    target = none
    categories = { op_cat_subterfuge op_cat_diplomacy }
    picture = GFX_evt_spymaster
    desc = op_counter_check_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 1000
			influence = 50
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_counter_check_too_recent
            owner = {
                NOT = { has_country_flag = recently_counter_check@root.target }
            }
        }
        custom_tooltip = {
            fail_text = operation_dis_inform_too_recent
            owner = {
                NOT = { has_country_flag = recently_dis_inform }
            }
        }		
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20450
    }
    stage = { #승인
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_target
        event = operation.20451
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 공격적 암호 적용
op_aggresive_use = {
    target = none
    categories = { op_cat_subterfuge op_cat_government }
    picture = GFX_evt_spymaster
    desc = op_aggresive_use_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 1000
			influence = 50
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_aggresive_use_too_recent
            owner = {
                NOT = { has_country_flag = recently_aggresive_use@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20150
    }
    stage = { #승인
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_target
        event = operation.20151
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 공격적 첩보망 확장
op_aggresive_net = {
    target = none
    categories = { op_cat_subterfuge op_cat_government }
    picture = GFX_evt_spymaster
    desc = op_aggresive_net_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 1000
			influence = 50
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_aggresive_net_too_recent
            owner = {
                NOT = { has_country_flag = recently_aggresive_net@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20200
    }
    stage = { #승인
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_target
        event = operation.20201
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 목표국 담당부서 확충
op_expend_division = {
    target = none
    categories = { op_cat_subterfuge op_cat_government }
    picture = GFX_evt_spymaster
    desc = op_expend_division_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 1000
			influence = 50
        }
        upkeep = {
            energy = 5
			influence = 0.5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_expend_division_too_recent
            owner = {
                NOT = { has_country_flag = recently_expend_division@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_ta
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20460
    }
    stage = { #승인
        difficulty = @diff_ta
        icon = GFX_espionage_chapter_icon_target
        event = operation.20461
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 특수활동비 재배정
op_budget_allin = {
    target = none
    categories = { op_cat_subterfuge op_cat_economy }
    picture = GFX_evt_spymaster
    desc = op_budget_allin_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 4000
			influence = 150
        }
        upkeep = {
            energy = 5
			influence = 1
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = no			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_budget_allin_too_recent
            owner = {
                NOT = { has_country_flag = recently_budget_allin@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20470
    }
    stage = { #승인
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_target
        event = operation.20471
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 네메시스 프로젝트 - 천체 생물학 무기화
op_nemesis_gene = {
    target = none
    categories = { op_cat_provocation op_cat_technology }
    picture = GFX_evt_spymaster
    desc = op_nemesis_gene_desc
    stages = 4

    resources = {
        category = operations
        cost = {
            energy = 5000
			influence = 150
        }
        upkeep = {
            energy = 10
			society_research = 75
			influence = 1
        }
    }

    spy_power_cost = 70
    potential = {
        always = no
		#has_nemesis = yes 
        #root.owner = {
        #    has_ascension_perk = ap_engineered_evolution  ## 진화설계 승천퍽이 있어야 함
		#	is_ai = no
        #target = { is_primitive = no }		
    }
    allow = {
        custom_tooltip = {
            fail_text = operation_nemesis_too_recent
            owner = {
                NOT = { has_country_flag = recently_nemesis@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #4페이즈나 있으니까
        difficulty = @diff_t8
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20300
    }
    stage = { #여기 2페이즈 부터는
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20301
    }	
    stage = { #돌파 난이도를
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20302
    }
    stage = { #1씩만 낮추자
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20303
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 네메시스 프로젝트 - 대량 제로데이 공습
op_nemesis_robo = {
    target = none
    categories = { op_cat_provocation op_cat_military }
    picture = GFX_evt_spymaster
    desc = op_nemesis_robo_desc
    stages = 4

    resources = {
        category = operations
        cost = {
            energy = 10000
			influence = 150
        }
        upkeep = {
            energy = 50
			influence = 1
        }
    }

    spy_power_cost = 70
    potential = {
        always = no
		#has_nemesis = yes 
        #root.owner = {
		#	OR = {
		#		has_ascension_perk = ap_the_flesh_is_weak  ## 육신은 나약하다 승천퍽이 있어야 함
				#has_ascension_perk = ap_organo_machine_interfacing  ## 유기-기계 인터페이스 승천퍽이 있어야 함
				#has_ascension_perk = ap_organo_machine_interfacing_assimilator  ## 유기-기계 인터페이스 승천퍽이 있어야 함
		#		has_ascension_perk = ap_synthetic_evolution  ## 신스진화 승천퍽이 있어야 함
		#		has_ascension_perk = ap_synthetic_age  ## 신스시대 승천퍽이 있어야 함
		#	}
		#	is_ai = no
        #target = { is_primitive = no }	
        }
    allow = {
        custom_tooltip = {
            fail_text = operation_nemesis_too_recent
            owner = {
                NOT = { has_country_flag = recently_nemesis@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t8
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20310
    }
    stage = { #Target identified
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20311
    }
    stage = { #Target identified
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20312
    }	
    stage = { #Result
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20313
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 네메시스 프로젝트 - 초월적 사이킥 써지
op_nemesis_psyc = {
    target = none
    categories = { op_cat_provocation op_cat_government }
    picture = GFX_evt_spymaster
    desc = op_nemesis_psyc_desc
    stages = 4

    resources = {
        category = operations
        cost = {
            energy = 2500
			unity = 5000
			sr_zro = 50
			influence = 150
        }
        upkeep = {
            energy = 10
			unity = 50
			sr_zro = 1
			influence = 1
        }
    }

    spy_power_cost = 70
    potential = {
        always = no
		#has_nemesis = yes 
        #root.owner = {
        #    has_ascension_perk = ap_mind_over_matter  ## 육신을 초월한 정신 승천퍽이 있어야 함
		#	is_ai = no
        #}		
		#target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_nemesis_too_recent
            owner = {
                NOT = { has_country_flag = recently_nemesis@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t8
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20320
    }
    stage = { #Target identified
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20321
    }
    stage = { #Target identified
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20322
    }	
    stage = { #Result
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20323
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

##################################
##### 이 아래로는 AI들이 사용하게될 첩보 #####
##################################

## 심층 기술 탈취-물리학
op_ai_steal_tech_physics = {
    target = none
    categories = { op_cat_subterfuge op_cat_technology }
    picture = GFX_evt_physics_research
    desc = op_ai_steal_tech_physics_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 790
			influence = 10
        }
        upkeep = {
            energy = 10
        }
    }

    spy_power_cost = 45 #이걸 왜 조정느냐? 사람은 작전을 진행하다가 첩보망 수치가 까이면 각을 재서 작전을 취소하거나 존버할수 있지만, AI새기들은 작전하다 락걸리면 다시 자연적으로 첩보망 오를때까지 영원히 그상태로 처박아두기 때문
    #spy_network_lvl_requirement = 45 아니 패독새끼들 이 코드를 통째로 없애버리면 어떻하냐 이럼 멍청한 AI를 어캐 땜빵하라고; 십련들 
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = yes			
        }	
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_steal_technology_enigmatic_engineering
            root.owner = {
                NOT = { has_country_flag = cannot_steal_enigmatic_tech@root.target } #set after failing this operation before, due to Enigmatic Engineering
            }
        }
		custom_tooltip = {
			fail_text = operation_steal_technology_too_recent
			NOT = { has_spynetwork_flag = recently_stole_technology }
		}
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = {
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1020
    }
    stage = {
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1021
    }	
    stage = {
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20000
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = {
            RANDOM_EVENTS = operation_random_events_generic
        }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 심층 기술 탈취-사회학
op_ai_steal_tech_society = {
    target = none
    categories = { op_cat_subterfuge op_cat_technology }
    picture = GFX_evt_physics_research
    desc = op_ai_steal_tech_society_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 790
			influence = 10
        }
        upkeep = {
            energy = 10
        }
    }

    spy_power_cost = 45 #이걸 왜 조정느냐? 사람은 작전을 진행하다가 첩보망 수치가 까이면 각을 재서 작전을 취소하거나 존버할수 있지만, AI새기들은 작전하다 락걸리면 다시 자연적으로 첩보망 오를때까지 영원히 그상태로 처박아두기 때문
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = yes			
        }	
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_steal_technology_enigmatic_engineering
            root.owner = {
                NOT = { has_country_flag = cannot_steal_enigmatic_tech@root.target } #set after failing this operation before, due to Enigmatic Engineering
            }
        }
		custom_tooltip = {
			fail_text = operation_steal_technology_too_recent
			NOT = { has_spynetwork_flag = recently_stole_technology }
		}
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = {
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1020
    }
    stage = {
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1021
    }	
    stage = {
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20003
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = {
            RANDOM_EVENTS = operation_random_events_generic
        }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 심층 기술 탈취-공학
op_ai_steal_tech_engineering = {
    target = none
    categories = { op_cat_subterfuge op_cat_technology }
    picture = GFX_evt_physics_research
    desc = op_ai_steal_tech_engineering_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 850
			influence = 10
        }
        upkeep = {
            energy = 10
        }
    }

    spy_power_cost = 45 #이걸 왜 조정느냐? 사람은 작전을 진행하다가 첩보망 수치가 까이면 각을 재서 작전을 취소하거나 존버할수 있지만, AI새기들은 작전하다 락걸리면 다시 자연적으로 첩보망 오를때까지 영원히 그상태로 처박아두기 때문
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = yes			
        }	
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_steal_technology_enigmatic_engineering
            root.owner = {
                NOT = { has_country_flag = cannot_steal_enigmatic_tech@root.target } #set after failing this operation before, due to Enigmatic Engineering
            }
        }
		custom_tooltip = {
			fail_text = operation_steal_technology_too_recent
			NOT = { has_spynetwork_flag = recently_stole_technology }
		}
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = {
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1020
    }
    stage = {
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.1021
    }	
    stage = {
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20006
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = {
            RANDOM_EVENTS = operation_random_events_generic
        }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 무역협정 로비
op_ai_trade_agreement = {
    target = none
    categories = { op_cat_manipulation op_cat_diplomacy }
    picture = GFX_evt_acquire_asset
    desc = op_ai_trade_agreement_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 600
			influence = 5
        }
        upkeep = {
            energy = 6
        }
    }

    spy_power_cost = 25
    potential = { 
		has_nemesis = yes 
        owner = { is_gestalt = no }
        target = { is_gestalt = no }
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_trade_agreement_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_trade_agreement@root.target }
            }
        }
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
        custom_tooltip = { ##토탈워 제국이면 이거 못걸게
            fail_text = target_is_purge_empire
            owner = {
                NOT = { ##근데 원래도 군체와 기계한텐 못쓰게 만들었으니까 그냥 정화자 시빅 하나만 더 조건에 추가하면 되겠네?
					has_valid_civic = civic_fanatic_purifiers		
				}
            }			
        }		
    }
    stage = { #Install operatives
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20010
    }
    stage = { #Target identified
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_target
        event = operation.20011
    }	
    stage = { #Result
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20012
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 금융위기 조장
op_ai_financial_crisis = {
    target = none
    categories = { op_cat_provocation op_cat_economy }
    picture = GFX_evt_acquire_asset
    desc = op_ai_financial_crisis_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 790
			influence = 15
        }
        upkeep = {
            energy = 10
        }
    }

    spy_power_cost = 45
    potential = { 
		has_nemesis = yes 
        target = { is_gestalt = no }	
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_financial_crisis_too_danger
            owner = {
                NOT = { has_modifier = lia_op_finance_c }
            }
        }
        custom_tooltip = {
            fail_text = operation_financial_crisis_too_danger2
            owner = {
                NOT = { has_modifier = lia_op_finance_e }
            }
        }		
        custom_tooltip = {
            fail_text = operation_financial_crisis_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_financial_crisis@root.target }
            }
        }
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20020
    }
    stage = { #Target identified
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20021
    }
    stage = { #Result
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20022
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 자원생산 사보타주
op_ai_resource_sabotage = {
    target = none
    categories = { op_cat_sabotage op_cat_economy }
    picture = GFX_evt_acquire_asset
    desc = op_ai_resource_sabotage_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 790
			influence = 10
        }
        upkeep = {
            energy = 8
        }
    }

    spy_power_cost = 35
	
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = yes			
        }	
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_sabotage_resource_no_targets
            target = {
                any_owned_planet = {
                    OR = {
						num_districts = { type = district_generator value > 1 }
						num_districts = { type = district_mining value > 1 }
						num_districts = { type = district_farming value > 1 }		
						num_districts = { type = district_rw_generator value > 0 }
						num_districts = { type = district_rw_farming value > 0 }
						num_districts = { type = district_hab_energy value > 1 }
						num_districts = { type = district_hab_mining value > 1 }
                    }
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20030
    }
    stage = { #Target identified
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_target
        event = operation.20031
    }	
    stage = { #Result
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20032
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 전략물자 비축분 테러
op_ai_strategic_materials = {
    target = none
    categories = { op_cat_sabotage op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_ai_strategic_materials_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 790
			influence = 10
        }
        upkeep = {
            energy = 8
        }
    }

    spy_power_cost = 40
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_strategic_materials_no_targets
            target = {
                OR = {
					resource_stockpile_compare = {
						resource = alloys
						value > 500
					}
					resource_stockpile_compare = {
						resource = volatile_motes
						value > 200
					}
					resource_stockpile_compare = {
						resource = exotic_gases
						value > 200
					}
					resource_stockpile_compare = {
						resource = rare_crystals
						value > 200
					}					
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20040
    }
    stage = { #Target identified
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_target
        event = operation.20041
    }	
    stage = { #Result
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20042
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 가짜뉴스 살포
op_ai_fake_news = {
    target = none
    categories = { op_cat_manipulation op_cat_government }
    picture = GFX_evt_acquire_asset
    desc = op_ai_fake_news_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 700
			influence = 10
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 30
    potential = { 
		has_nemesis = yes 
        target = { is_gestalt = no }
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_fake_news_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_fake_news@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20050
    }
    stage = { #Target identified
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_target
        event = operation.20051
    }	
    stage = { #Result
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20052
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 반정부 시위 후원
op_ai_support_antigov = {
    target = none
    categories = { op_cat_subterfuge op_cat_government }
    picture = GFX_evt_acquire_asset
    desc = op_ai_support_antigov_desc
    stages = 3

    resources = {
        category = operations
        cost = {
            energy = 790
			influence = 10
        }
        upkeep = {
            energy = 6
        }
    }

    spy_power_cost = 40
    potential = { 
		has_nemesis = yes 
        target = { is_gestalt = no }	
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_support_antigov_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_support_antigov@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20060
    }
    stage = { #Target identified
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_target
        event = operation.20061
    }	
    stage = { #Result
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20062
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 전쟁범죄 공론화
op_ai_war_crime = {
    target = none
    categories = { op_cat_manipulation op_cat_diplomacy }
    picture = GFX_evt_acquire_asset
    desc = op_ai_war_crime_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 750
			influence = 10
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 25
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_war_crime_in_war
            target = {
				off_war_exhaustion_sum > 0
            }
        }
        custom_tooltip = {
            fail_text = operation_war_crime_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_war_crime@root.target }
            }
        }		
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20070
    }
    stage = { #Target identified
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_target
        event = operation.20071
    }	
    stage = { #Result
        difficulty = @diff_t2
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20072
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 훈련중 함선사고 유발
op_ai_ship_accident = {
    target = none
    categories = { op_cat_sabotage op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_ai_ship_accident_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 400
			influence = 10
        }
        upkeep = {
            energy = 10
        }
    }

    spy_power_cost = 40	#45
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_ship_accident_no_targets
            target = {
                any_owned_ship = {
                    OR = {
						is_ship_size = corvette
						is_ship_size = destroyer
						is_ship_size = cruiser
						is_ship_size = battleship
						is_ship_size = titan						
                    }
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20130
    }
    stage = { #Target identified
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20131
    }	
    stage = { #Result
        difficulty = @diff_t3	#4
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20132
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 하이퍼레인 항법시스템 방해
op_ai_hyperlane_dist = {
    target = none
    categories = { op_cat_subterfuge op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_ai_hyperlane_dist_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 700
			influence = 10
        }
        upkeep = {
			energy = 10
        }
    }

    spy_power_cost = 35
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_hyperlane_dist_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_hyperlane_dist@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20140
    }
    stage = { #Target identified
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20141
    }	
    stage = { #Result
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20142
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 공격적 암호 적용
op_ai_aggresive_use = {
    target = none
    categories = { op_cat_subterfuge op_cat_government }
    picture = GFX_evt_spymaster
    desc = op_ai_aggresive_use_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 500
			influence = 10
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_aggresive_use_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_aggresive_use@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20150
    }
    stage = { #승인
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_target
        event = operation.20151
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 공격적 첩보망 확장
op_ai_aggresive_net = {
    target = none
    categories = { op_cat_subterfuge op_cat_government }
    picture = GFX_evt_spymaster
    desc = op_ai_aggresive_net_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 500
			influence = 10
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_aggresive_net_too_recent
            owner = {
                NOT = { has_country_flag = recently_aggresive_net@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20200
    }
    stage = { #승인
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_target
        event = operation.20201
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 네메시스 프로젝트 - 천체 생물학 무기화
op_ai_nemesis_gene = {
    target = none
    categories = { op_cat_provocation op_cat_technology }
    picture = GFX_evt_spymaster
    desc = op_ai_nemesis_gene_desc
    stages = 4

    resources = {
        category = operations
        cost = {
            energy = 3000
			influence = 100
        }
        upkeep = {
            energy = 50
        }
    }

    spy_power_cost = 65
    potential = { 
		has_nemesis = yes 
        root.owner = {
            has_ascension_perk = ap_engineered_evolution  ## 진화통달 승천퍽이 있어야 함
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_nemesis_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_nemesis@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20300
    }
    stage = { #Target identified
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20301
    }	
    stage = { #Result
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20302
    }
    stage = { #Result
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20303
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 네메시스 프로젝트 - 대량 제로데이 공습
op_ai_nemesis_robo = {
    target = none
    categories = { op_cat_provocation op_cat_military }
    picture = GFX_evt_spymaster
    desc = op_ai_nemesis_robo_desc
    stages = 4

    resources = {
        category = operations
        cost = {
            energy = 3000
			influence = 100
        }
        upkeep = {
            energy = 50
        }
    }

    spy_power_cost = 65
    potential = { 
		has_nemesis = yes 
        root.owner = {
			OR = {
				has_ascension_perk = ap_the_flesh_is_weak  ## 육신은 나약하다 승천퍽이 있어야 함
				#has_ascension_perk = ap_organo_machine_interfacing  ## 유기-기계 인터페이스 승천퍽이 있어야 함
				#has_ascension_perk = ap_organo_machine_interfacing_assimilator  ## 유기-기계 인터페이스 승천퍽이 있어야 함
				has_ascension_perk = ap_synthetic_evolution  ## 신스진화 승천퍽이 있어야 함
				has_ascension_perk = ap_synthetic_age  ## 신스시대 승천퍽이 있어야 함
			}
			is_ai = yes		
        }		
		target = { is_primitive = no }		
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_nemesis_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_nemesis@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20310
    }
    stage = { #Target identified
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20311
    }
    stage = { #Target identified
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20312
    }	
    stage = { #Result
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20313
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 네메시스 프로젝트 - 초월적 사이킥 써지
op_ai_nemesis_psyc = {
    target = none
    categories = { op_cat_provocation op_cat_government }
    picture = GFX_evt_spymaster
    desc = op_ai_nemesis_psyc_desc
    stages = 4

    resources = {
        category = operations
        cost = {
            energy = 3000
			influence = 100
        }
        upkeep = {
            energy = 50
        }
    }

    spy_power_cost = 65
    potential = { 
		has_nemesis = yes 
        root.owner = {
            has_ascension_perk = ap_mind_over_matter  ## 초월 승천퍽이 있어야 함
			is_ai = yes
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_nemesis_too_recent
            root.owner = {
                NOT = { has_country_flag = recently_nemesis@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20320
    }
    stage = { #Target identified
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20321
    }
    stage = { #Target identified
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_target
        event = operation.20322
    }	
    stage = { #Result
        difficulty = @diff_t7
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20323
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 자원 탈취
op_ai_mineral_plunder = {
    target = none
    categories = { op_cat_sabotage op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_mineral_plunder_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 800
			influence = 10
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 35
    potential = { 
		has_nemesis = yes 
        #target = { is_hive_empire = yes }
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_mineral_plunder_no_targets
            target = {
                OR = {
					resource_stockpile_compare = {
						resource = food
						value > 2000
					}
					resource_stockpile_compare = {
						resource = minerals
						value > 2000
					}				
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20410
    }
    stage = { #Target identified
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_target
        event = operation.20411
    }	
    stage = { #Result
        difficulty = @diff_t4
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20412
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 크레딧 빼돌리기
op_ai_credit_plunder = {
    target = none
    categories = { op_cat_sabotage op_cat_economy }
    picture = GFX_evt_acquire_asset
    desc = op_credit_plunder_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 800
			influence = 10
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 35
    potential = { 
		has_nemesis = yes 
        #target = { is_hive_empire = yes }
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_credit_plunder_no_targets
            target = {
				resource_stockpile_compare = {
					resource = energy
					value > 2000
				}				
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20420
    }
    stage = { #Target identified
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_target
        event = operation.20421
    }	
    stage = { #Result
        difficulty = @diff_t3
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20422
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 군체의식 신경망 교란
op_ai_disturb_hive = {
    target = none
    categories = { op_cat_provocation op_cat_technology }
    picture = GFX_evt_acquire_asset
    desc = op_disturb_hive_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 1200
			influence = 15
        }
        upkeep = {
            energy = 10
        }
    }

    spy_power_cost = 45
    potential = { 
		has_nemesis = yes 
        target = { is_hive_empire = yes }
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_disturb_hive_too_recent
            owner = {
                NOT = { has_country_flag = recently_disturb_hive@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20090
    }
    stage = { #Target identified
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_target
        event = operation.20091
    }	
    stage = { #Result
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20092
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 기계지능 연산망 교란
op_ai_disturb_mach = {
    target = none
    categories = { op_cat_provocation op_cat_technology }
    picture = GFX_evt_acquire_asset
    desc = op_disturb_mach_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 1200
			influence = 15
        }
        upkeep = {
			energy = 10
        }
    }

    spy_power_cost = 45
    potential = { 
		has_nemesis = yes 
        target = { is_machine_empire = yes }	
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_disturb_mach_too_recent
            owner = {
                NOT = { has_country_flag = recently_disturb_mach@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20100
    }
    stage = { #Target identified
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_target
        event = operation.20101
    }	
    stage = { #Result
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20102
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}
## 훈련중 대규모 함대사고 유발
op_ai_fleet_accident = {
    target = none
    categories = { op_cat_sabotage op_cat_military }
    picture = GFX_evt_acquire_asset
    desc = op_fleet_accident_desc
    stages = 3

    resources = {
        category = operations
        cost = {
			energy = 1200
			influence = 20
        }
        upkeep = {
            energy = 10
        }
    }

    spy_power_cost = 50
    potential = { 
		has_nemesis = yes 
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_fleet_accident_too_recent
            owner = {
                NOT = { has_country_flag = recently_fleet_accident@root.target }
            }
        }	
        custom_tooltip = {
            fail_text = operation_fleet_accident_no_targets
            target = {
                any_owned_ship = {
                    OR = {
						is_ship_size = corvette
						is_ship_size = destroyer
						is_ship_size = cruiser
						is_ship_size = battleship
						is_ship_size = titan						
                    }
                }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #Install operatives
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20430
    }
    stage = { #Target identified
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_target
        event = operation.20431
    }	
    stage = { #Result
        difficulty = @diff_t5
        icon = GFX_espionage_chapter_icon_motion
        event = operation.20432
    }
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 적대적 첩보망 조사
op_ai_spy_check = {
    target = none
    categories = { op_cat_subterfuge op_cat_diplomacy }
    picture = GFX_evt_spymaster
    desc = op_spy_check_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 500
			influence = 10
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_spy_check_too_recent
            owner = {
                NOT = { has_country_flag = recently_spy_check@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20440
    }
    stage = { #승인
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_target
        event = operation.20441
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 목표국 담당부서 확충
op_ai_expend_division = {
    target = none
    categories = { op_cat_subterfuge op_cat_government }
    picture = GFX_evt_spymaster
    desc = op_expend_division_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 500
			influence = 20
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_expend_division_too_recent
            owner = {
                NOT = { has_country_flag = recently_expend_division@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_ta
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20460
    }
    stage = { #승인
        difficulty = @diff_ta
        icon = GFX_espionage_chapter_icon_target
        event = operation.20461
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}

## 특수활동비 재배정
op_ai_budget_allin = {
    target = none
    categories = { op_cat_subterfuge op_cat_economy }
    picture = GFX_evt_spymaster
    desc = op_budget_allin_desc
    stages = 2

    resources = {
        category = operations
        cost = {
			energy = 1000
			influence = 10
        }
        upkeep = {
            energy = 5
        }
    }

    spy_power_cost = 5
    potential = { 
		has_nemesis = yes 	
        root.owner = {
			is_ai = yes			
        }		
		target = { is_primitive = no }
	}
    allow = {
        custom_tooltip = {
            fail_text = operation_budget_allin_too_recent
            owner = {
                NOT = { has_country_flag = recently_budget_allin@root.target }
            }
        }	
        custom_tooltip = {
            is_running_espionage_operation = no
            fail_text = operation_one_at_a_time
        }
    }
    stage = { #준비
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_surveillance
        event = operation.20470
    }
    stage = { #승인
        difficulty = @diff_tm
        icon = GFX_espionage_chapter_icon_target
        event = operation.20471
    }	
    on_roll_failed = {
        standard_espionage_operation_on_roll_failed = { RANDOM_EVENTS = operation_random_events_generic }
    }
    on_create = {
        target = {
            set_timed_country_flag = {
                flag = espionage_operation_targeted_by@root.owner #Used in random Spy Network events
                days = @operationTargetedByTimer
            }
        }
    }
}